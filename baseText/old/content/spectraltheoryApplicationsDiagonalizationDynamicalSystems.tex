\section{Application: Dynamical systems}

The migration matrices discussed above give an example of a discrete
dynamical system. We call them discrete because they involve discrete
values taken at a sequence of points rather than on a continuous
interval of time.

An example of a situation which can be studied in this way is a
predator prey model. Consider the following model where $x$ is the
number of prey and $y$ the number of predators in a certain area at a
certain time. These are functions of $n\in \N$ where $n=1,2,\ldots$
are the ends of intervals of time which may be of interest in the
problem. In other words, $x (n)$ is the number of prey at the end of
the $n\th$ interval of time.  An example of this situation may be
modelled by the following equation
\begin{equation*}
  \begin{mymatrix}{c}
    x(n+1) \\
    y(n+1)
  \end{mymatrix} =\begin{mymatrix}{rr}
    2 & -3 \\
    1 & 4
  \end{mymatrix} \begin{mymatrix}{c}
    x(n) \\
    y(n)
  \end{mymatrix}.
\end{equation*}
This says that from time period $n$ to $n+1$, $x$ increases if there
are more $x$ and decreases as there are more $y$. In the context of
this example, this means that as the number of predators increases,
the number of prey decreases. As for $y$, it increases if there are
more $y$ and also if there are more $x$.

This is an example of a matrix recurrence which we define now.

\begin{definition}{Matrix recurrence}{matrix-recurrence}
  Suppose a dynamical system is given by
  \begin{eqnarray*}
    x_{n+1} &=& a x_n + b y_n \\
    y_{n+1} &=& c x_n + d y_n
  \end{eqnarray*}
  This system can be expressed as $V_{n+1} = A V_{n}$ where
  $V_{n} = \begin{mymatrix}{r}
    x_n \\
    y_n
  \end{mymatrix}$ and $A = \begin{mymatrix}{rr}
    a & b \\
    c & d
  \end{mymatrix}$.
\end{definition}

In this section, we will examine how to find solutions to a dynamical
system given certain initial conditions. This process involves several
concepts previously studied, including matrix diagonalization and
Markov matrices. The procedure is given as follows. Recall that when
diagonalized, we can write $A^{n} = PD^{n}P^{-1}$.

\begin{procedure}{Solving a dynamical system}{solving-dynamical}
  Suppose a dynamical system is given by
  \begin{eqnarray*}
    x_{n+1} &=& a x_n + b y_n \\
    y_{n+1} &=& c x_n + d y_n
  \end{eqnarray*}
  Given initial conditions $x_0$ and $y_0$, the solutions to the
  system are found as follows:
  \begin{enumerate}
  \item Express the dynamical system in the form $V_{n+1} = AV_n$.
  \item Diagonalize $A$ to be written as $A = PDP^{-1}$.
  \item Then $V_{n} = PD^{n} P^{-1} V_{0}$ where $V_{0}$ is the vector
    containing the initial conditions.
  \item If given specific values for $n$, substitute into this
    equation. Otherwise, find a general solution for $n$.
  \end{enumerate}
\end{procedure}

We will now consider an example in detail.

\begin{example}{Solutions of a discrete dynamical system}{solutions-dynamical-system}
  Suppose a dynamical system is given by
  \begin{eqnarray*}
    x_{n+1} &=& 1.5 x_n - 0.5y_n\\
    y_{n+1} &=& 1.0 x_n
  \end{eqnarray*}

  Express this system as a matrix recurrence and find solutions to the
  dynamical system for initial conditions $x_0=20, y_0=10$.
\end{example}

\begin{solution}
  First, we express the system as a matrix recurrence.
  \begin{eqnarray*}
    V_{n+1} &=& AV_{n}\\
    \begin{mymatrix}{c}
      x(n+1) \\
      y(n+1)
    \end{mymatrix} &=&\begin{mymatrix}{rr}
      1.5 & -0.5 \\
      1.0 & 0
    \end{mymatrix} \begin{mymatrix}{c}
      x(n) \\
      y(n)
    \end{mymatrix}.
  \end{eqnarray*}
  Then
  \begin{equation*}
    A
    =
    \begin{mymatrix}{rr}
      1.5 & -0.5 \\
      1.0 & 0
    \end{mymatrix}.
  \end{equation*}
  You can verify that the eigenvalues of $A$ are $1$ and $0.5$. By
  diagonalizing, we can write $A$ in the form
  \begin{equation*}
    P^{-1} D P =
    \begin{mymatrix}{rr}
      1 & 1 \\
      1 & 2
    \end{mymatrix} \begin{mymatrix}{rr}
      1 & 0 \\
      0 & 0.5
    \end{mymatrix} \begin{mymatrix}{rr}
      2 & -1 \\
      -1 & 1
    \end{mymatrix}.
  \end{equation*}
  Now given an initial condition
  \begin{equation*}
    V_0 = \begin{mymatrix}{c}
      x_{0} \\
      y_{0}
    \end{mymatrix},
  \end{equation*}
  the solution to the dynamical system is given by
  \begin{eqnarray*}
    V_n &=& P D^n P^{-1} V_0\\
    \begin{mymatrix}{c}
      x(n) \\
      y(n)
    \end{mymatrix} &=&\begin{mymatrix}{rr}
      1 & 1 \\
      1 & 2
    \end{mymatrix} \begin{mymatrix}{rr}
      1 & 0 \\
      0 & 0.5
    \end{mymatrix} ^{n}\begin{mymatrix}{rr}
      2 & -1 \\
      -1 & 1
    \end{mymatrix} \begin{mymatrix}{c}
      x_{0} \\
      y_{0}
    \end{mymatrix} \\
        &=& \begin{mymatrix}{rr}
          1 & 1 \\
          1 & 2
        \end{mymatrix} \begin{mymatrix}{rr}
          1 & 0 \\
          0 & (0.5) ^{n}
        \end{mymatrix} \begin{mymatrix}{rr}
          2 & -1 \\
          -1 & 1
        \end{mymatrix} \begin{mymatrix}{c}
          x_{0} \\
          y_{0}
        \end{mymatrix} \\
        &=&\begin{mymatrix}{c}
          y_{0}((0.5) ^{n}-1) -x_{0}((0.5)
          ^{n}-2) \\
          y_{0}(2(0.5) ^{n}-1) -x_{0}(2(0.5)
          ^{n}-2)
        \end{mymatrix}.
  \end{eqnarray*}
  If we let $n$ become arbitrarily large, this vector approaches
  \begin{equation*}
    \begin{mymatrix}{c}
      2x_{0}-y_{0} \\
      2x_{0}-y_{0}
    \end{mymatrix}.
  \end{equation*}
  Thus for large $n$,
  \begin{equation*}
    \begin{mymatrix}{c}
      x(n) \\
      y(n)
    \end{mymatrix} \approx \begin{mymatrix}{c}
      2x_{0}-y_{0} \\
      2x_{0}-y_{0}
    \end{mymatrix}.
  \end{equation*}
  Now suppose the initial condition is given by
  \begin{equation*}
    \begin{mymatrix}{c}
      x_{0} \\
      y_{0}
    \end{mymatrix}
    =
    \begin{mymatrix}{r}
      20 \\
      10
    \end{mymatrix}.
  \end{equation*}
  Then, we can find solutions for various values of $n$. Here are the
  solutions for values of $n$ between $1$ and $5$:
  \begin{equation*}
    n=1:
    \begin{mymatrix}{r}
      25.0 \\
      20.0
    \end{mymatrix},
    n=2: \begin{mymatrix}{r}
      27.5 \\
      25.0
    \end{mymatrix},
    n=3: \begin{mymatrix}{r}
      28.75 \\
      27.5
    \end{mymatrix}
  \end{equation*}
  \begin{equation*}
    n=4: \begin{mymatrix}{r}
      29.375 \\
      28.75
    \end{mymatrix},
    n=5: \begin{mymatrix}{r}
      29.688 \\
      29.375
    \end{mymatrix}.
  \end{equation*}
  Notice that as $n$ increases, we approach the vector given by
  \begin{equation*}
    \begin{mymatrix}{c}
      2x_{0}-y_{0} \\
      2x_{0}-y_{0}
    \end{mymatrix}
    =
    \begin{mymatrix}{r}
      2(20)- 10\\
      2(20)-10
    \end{mymatrix}
    =
    \begin{mymatrix}{r}
      30\\
      30
    \end{mymatrix}.
  \end{equation*}
  These solutions are graphed in the following figure.
  \begin{center}
    \begin{tikzpicture}[font=\small]
      \draw[<->](0,2) --(0,0)--(2,0);
      \draw (0.5, -0.05)--(0.5,0.05);
      \draw (1, -0.05)--(1,0.05);
      \draw (1.5, -0.05)--(1.5,0.05);
      \draw (-0.05, 0.5)--(0.05,0.5);
      \draw (-0.05, 1)--(0.05,1);
      \draw (-0.05, 1.5)--(0.05,1.5);
      \draw[fill] (0.8,0.75) circle [radius=0.025];
      \draw[fill] (1.2,1.3) circle [radius=0.025];
      \draw[fill] (1.45,1.6) circle [radius=0.025];
      \node[right] at (2,0){x};
      \node[right] at (0,2){y};
      \node[below] at (0.5,0){$28$};
      \node[below] at (1,0){$29$};
      \node[below] at (1.5,0){$30$};
      \node[left] at (0,0.5){$27$};
      \node[left] at (0,1){$28$};
      \node[left] at (0,1.5){$29$};
    \end{tikzpicture}
  \end{center}
\end{solution}

The following example demonstrates another system which exhibits some
interesting behavior. When we graph the solutions, it is possible for
the ordered pairs to spiral around the origin.

\begin{example}{Finding solutions to a dynamical system}{find-solutions-dynamical-system}
  Suppose a dynamical system is of the form
  \begin{equation*}
    \begin{mymatrix}{c}
      x(n+1) \\
      y(n+1)
    \end{mymatrix} =\begin{mymatrix}{rr}
      0.7 & 0.7 \\
      -0.7 & 0.7
    \end{mymatrix} \begin{mymatrix}{c}
      x(n) \\
      y(n)
    \end{mymatrix}.
  \end{equation*}
  Find solutions to the dynamical system for given initial conditions.
\end{example}

\begin{solution}
  Let
  \begin{equation*}
    A
    =
    \begin{mymatrix}{rr}
      0.7 & 0.7 \\
      -0.7 & 0.7
    \end{mymatrix}.
  \end{equation*}
  To find solutions, we must diagonalize $A$. You can verify that the
  eigenvalues of $A$ are complex and are given by
  $\eigenvar_1 = 0.7+0.7i$ and $\eigenvar_2 = 0.7-0.7i$. The eigenvector
  for $\eigenvar_1 = 0.7+0.7i$ is
  \begin{equation*}
    \begin{mymatrix}{r}
      1 \\
      i
    \end{mymatrix}
  \end{equation*}
  and that the eigenvector for $\eigenvar_2 = 0.7-0.7i$ is
  \begin{equation*}
    \begin{mymatrix}{r}
      1 \\
      -i
    \end{mymatrix}.
  \end{equation*}
  Thus the matrix $A$ can be written in the form
  \begin{equation*}
    \begin{mymatrix}{rr}
      1 & 1 \\
      i & -i
    \end{mymatrix} \begin{mymatrix}{cc}
      0.7+0.7i & 0 \\
      0 & 0.7-0.7i
    \end{mymatrix} \begin{mymatrix}{rr}
      \frac{1}{2} & -\frac{1}{2}i \\
      \frac{1}{2} & \frac{1}{2}i
    \end{mymatrix},
  \end{equation*}
  and so
  \begin{eqnarray*}
    V_n &=& PD^nP^{-1}V_0 \\
    \begin{mymatrix}{c}
      x(n) \\
      y(n)
    \end{mymatrix} &=&\begin{mymatrix}{rr}
      1 & 1 \\
      i & -i
    \end{mymatrix} \begin{mymatrix}{cc}
      (0.7+0.7i) ^{n} & 0 \\
      0 & (0.7-0.7i) ^{n}
    \end{mymatrix} \begin{mymatrix}{rr}
      \frac{1}{2} & -\frac{1}{2}i \\
      \frac{1}{2} & \frac{1}{2}i
    \end{mymatrix} \begin{mymatrix}{c}
      x_{0} \\
      y_{0}
    \end{mymatrix}.
  \end{eqnarray*}
  The explicit solution is given by
  \begin{equation*}
    \begin{mymatrix}{c}
      x_{0}(\frac{1}{2}(0.7-0.7i) ^{n}+\frac{1}{2}
      (0.7+0.7i) ^{n}) + \allowbreak y_{0}(\frac{1}{2}
      i(0.7-0.7i) ^{n}-\frac{1}{2}i (
      0.7+0.7i)  ^{n}) \\
      y_{0}(\frac{1}{2} (0.7-0.7i) ^{n}+\frac{1}{2}
      (0.7+0.7i) ^{n}) -  x_{0}(\frac{1}{2}
      i(0.7-0.7i) ^{n}-\frac{1}{2}i(
      0.7+0.7i) ^{n})
    \end{mymatrix}.
  \end{equation*}
  Suppose the initial condition is
  \begin{equation*}
    \begin{mymatrix}{c}
      x_{0} \\
      y_{0}
    \end{mymatrix} =\begin{mymatrix}{r}
      10 \\
      10
    \end{mymatrix}.
  \end{equation*}
  Then one obtains the following sequence of values which are graphed
  below by letting $n=1,2,\ldots,20$

  \begin{center}
    \includegraphics[bb=0 0 800 800,scale=.2]{figures/4dec.eps}
  \end{center}

  In this picture, the dots are the values and the dashed line is to
  help to picture what is happening.

  These points are getting gradually closer to the origin, but they
  are circling the origin in the clockwise direction as they do so. As
  $n$ increases, the vector $\begin{mymatrix}{c}
    x(n) \\
    y(n)
  \end{mymatrix}$ approaches $ \begin{mymatrix}{r}
    0 \\
    0
  \end{mymatrix}$.
\end{solution}

