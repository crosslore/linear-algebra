\subsection{$QR$ factorization}

In this section, a reliable factorization of matrices is studied. Called the $QR$ factorization of a matrix, it \textit{always} exists. While much can be said about the $QR$ factorization, this section will be limited to real matrices. Therefore we assume the dot product used below is the usual dot product. We begin with a definition. 

\begin{definition}{$QR$ factorization}{qrfactorization}
Let $A$ be a real $m\times n$ matrix. Then a $QR$ factorization of $A$ consists
of two matrices, $Q$ orthogonal and $R$ upper
triangular, such that $A=QR.$\index{QR factorization} 
\end{definition}

The following theorem claims that such a factorization exists. 

\begin{theorem}{Existence of $QR$ factorization}{existenceqr}
Let $A$ be any real $m\times n$ matrix with linearly independent columns. Then there exists an orthogonal
matrix $Q$ and an upper triangular matrix $R$ having non-negative entries
on the main diagonal such that
\begin{equation*}
A=QR
\end{equation*}
\end{theorem}

The procedure for obtaining the $QR$ factorization for any matrix $A$ is as follows.

\begin{procedure}{$QR$ factorization}{qrfactorization}
Let $A$ be an $m \times n$ matrix given by $A = \begin{mymatrix}{cccc}
A_1 & A_2 & \cdots & A_n 
\end{mymatrix}$ where the $A_i$ are the linearly independent columns of $A$. 
\begin{enumerate}
\item
Apply the Gram-Schmidt Process \ref{algo:gramschmidtalgorithm} to the columns of $A$, writing $B_i$ for the resulting columns.

\item
Normalize the $B_i$, to find $C_i = \frac{1}{\vectlength B_i \vectlength} B_i$. 

\item
Construct the orthogonal matrix $Q$ as $Q=\begin{mymatrix}{cccc}
C_1 & C_2 & \cdots & C_n 
\end{mymatrix}$. 

\item 
Construct the upper triangular matrix $R$ as 
\[ R = 
\begin{mymatrix}{ccccc}
\vectlength B_1 \vectlength & A_2 \dotprod C_1 & A_3 \dotprod C_1 & \cdots & A_n \dotprod C_1 \\
0 & \vectlength B_2 \vectlength & A_3 \dotprod C_2 & \cdots & A_n \dotprod C_2 \\
0 & 0 & \vectlength B_3 \vectlength & \cdots & A_n \dotprod C_3 \\
\vdots & \vdots & \vdots & & \vdots \\
0 & 0 & 0 & \cdots & \vectlength B_n \vectlength 
\end{mymatrix}
\]

\item
Finally, write $A=QR$ where $Q$ is the orthogonal matrix and $R$ is the upper triangular matrix obtained above. 
\end{enumerate} 
\end{procedure}

Notice that $Q$ is an orthogonal matrix as the $C_i$ form an orthonormal set. Since $\vectlength B_i \vectlength > 0$ for all $i$ (since the length of a vector is always positive), it follows that $R$ is an upper triangular matrix with positive entries on the main diagonal. 

Consider the following example.

\begin{example}{Finding a $QR$ factorization}{qrfactorization}
Let \[
A = \begin{mymatrix}{rr}
1 & 2 \\
0 & 1 \\
1 & 0 
\end{mymatrix}
\]
Find an orthogonal matrix $Q$ and upper triangular matrix $R$ such that $A=QR$. 
\end{example}

\begin{solution}
First, observe that $A_1$, $A_2$, the columns of $A$, are linearly independent. Therefore we can use the Gram-Schmidt Process to create a corresponding orthogonal set $\set{B_1, B_2 }$ as follows:
\begin{eqnarray*}
B_1 &=& A_1 = \begin{mymatrix}{r}
1 \\
0 \\
1
\end{mymatrix} \\
B_2 &=& A_2 - \frac{A_2 \dotprod B_1}{\vectlength B_1 \vectlength ^2} B_1 \\
&=& \begin{mymatrix}{r}
2 \\
1 \\
0
\end{mymatrix}
- \frac{2}{2} \begin{mymatrix}{r}
1 \\
0 \\
1
\end{mymatrix} \\
&=& 
\begin{mymatrix}{r}
1 \\
1 \\
-1
\end{mymatrix}
\end{eqnarray*}

Normalize each vector to create the set $\set{C_1, C_2 }$ as follows:
\begin{eqnarray*}
C_1 &=& \frac{1}{\vectlength B_1 \vectlength} B_1 = \frac{1}{\sqrt{2}}  \begin{mymatrix}{r}
1 \\
0 \\
1
\end{mymatrix} \\
C_2 &=& \frac{1}{\vectlength B_2 \vectlength} B_2 = \frac{1}{\sqrt{3}} \begin{mymatrix}{r}
1 \\
1 \\
-1 
\end{mymatrix}
\end{eqnarray*}

Now construct the orthogonal matrix $Q$ as 
\begin{eqnarray*}
Q &=& \begin{mymatrix}{cccc}
C_1 & C_2 & \cdots & C_n 
\end{mymatrix} \\
&=& \begin{mymatrix}{rr}
\vspace{0.05in}\frac{1}{\sqrt{2}} & \vspace{0.05in}\frac{1}{\sqrt{3}} \\
0  & \vspace{0.05in}\frac{1}{\sqrt{3}} \\
\vspace{0.05in}\frac{1}{\sqrt{2}} & -\vspace{0.05in}\frac{1}{\sqrt{3}}
\end{mymatrix}
\end{eqnarray*}

Finally, construct the upper triangular matrix $R$ as 
\begin{eqnarray*}
R &=& 
\begin{mymatrix}{cc}
\vectlength B_1 \vectlength & A_2 \dotprod C_1  \\
0 & \vectlength B_2 
\end{mymatrix} \\
&=& 
\begin{mymatrix}{cc}
\sqrt{2} & \sqrt{2} \\
0 & \sqrt{3} \\
\end{mymatrix}
\end{eqnarray*}

It is left to the reader to verify that $A=QR$. 
\end{solution}
