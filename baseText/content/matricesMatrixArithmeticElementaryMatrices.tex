\section{Elementary matrices}
\label{sec:elementary-matrices}

\begin{outcome}
  \begin{enumerate}
  \item Use multiplication by elementary matrices to apply row
    operations.
  \item Find the elementary matrix corresponding to a particular row
    operation.
  \item Write the {\rref} of a matrix $A$ in the form $R=UA$, where
    $U$ is invertible.
  \item Write a matrix as a product of elementary matrices.
  \end{enumerate}
\end{outcome}

% ----------------------------------------------------------------------
\subsection{Elementary matrices and row operations}

Recall from Definition~\ref{def:row-operations} that there are three
kinds of elementary row operations%
\index{matrix!row operation}%
\index{matrix!elementary row operation}%
\index{row operation}%
\index{elementary row operation} on matrices:
\begin{enumerate}
\item Switch two rows.
\item Multiply a row by a non-zero number.
\item Add a multiple of one row to another row.
\end{enumerate}
The purpose of this section is to show that each of these row
operations corresponds to a special type of invertible matrix called
an \textbf{elementary matrix}%
\index{elementary matrix}\index{matrix!elementary matrix}.

\begin{example}{Elementary matrix for switching two rows}{elementary-matrix-1}
  Let
  \begin{equation*}
    E ~=~ \begin{mymatrix}{lll}
      1 & 0 & 0 \\
      0 & 0 & 1 \\
      0 & 1 & 0 \\
    \end{mymatrix}.
  \end{equation*}
  What is the effect of multiplying $E$ by an arbitrary $3\times
  n$-matrix $A$?
\end{example}

\begin{solution}
  Consider an arbitrary $3\times n$-matrix
  \begin{equation*}
    A ~=~ \begin{mymatrix}{cccc}
      a_{11} & a_{12} & \cdots & a_{1n} \\
      a_{21} & a_{22} & \cdots & a_{2n} \\
      a_{31} & a_{32} & \cdots & a_{3n} \\
    \end{mymatrix}.
  \end{equation*}
  We compute the product $EA$ by the row method:
  \begin{equation*}
    EA ~=~ \begin{mymatrix}{lll}
      1 & 0 & 0 \\
      0 & 0 & 1 \\
      0 & 1 & 0 \\
    \end{mymatrix}
    \begin{mymatrix}{cccc}
      a_{11} & a_{12} & \cdots & a_{1n} \\
      a_{21} & a_{22} & \cdots & a_{2n} \\
      a_{31} & a_{32} & \cdots & a_{3n} \\
    \end{mymatrix}
    ~=~
    \begin{mymatrix}{cccc}
      a_{11} & a_{12} & \cdots & a_{1n} \\
      a_{31} & a_{32} & \cdots & a_{3n} \\
      a_{21} & a_{22} & \cdots & a_{2n} \\
    \end{mymatrix}.
  \end{equation*}
  So the effect of multiplying $A$ by $E$ on the left is exactly the
  same as switching rows 2 and 3. We say that $E$ is the
  \textbf{elementary matrix for switching rows 2 and 3}.
\end{solution}

\begin{example}{Elementary matrix for multiplying a row by a non-zero number}{elementary-matrix-2}
  Let
  \begin{equation*}
    E ~=~ \begin{mymatrix}{lll}
      1 & 0 & 0 \\
      0 & k & 0 \\
      0 & 0 & 1 \\
    \end{mymatrix}.
  \end{equation*}
  What is the effect of multiplying $E$ by an arbitrary $3\times
  n$-matrix $A$?
\end{example}

\begin{solution}
  We compute the product $EA$ by the row method:
  \begin{equation*}
    EA ~=~ \begin{mymatrix}{lll}
      1 & 0 & 0 \\
      0 & k & 0 \\
      0 & 0 & 1 \\
    \end{mymatrix}
    \begin{mymatrix}{cccc}
      a_{11} & a_{12} & \cdots & a_{1n} \\
      a_{21} & a_{22} & \cdots & a_{2n} \\
      a_{31} & a_{32} & \cdots & a_{3n} \\
    \end{mymatrix}
    ~=~
    \begin{mymatrix}{rrrr}
      a_{11} & a_{12} & \cdots & a_{1n} \\
      ka_{21} & ka_{22} & \cdots & ka_{2n} \\
      a_{31} & a_{32} & \cdots & a_{3n} \\
    \end{mymatrix}.
  \end{equation*}
  So the effect of multiplying $A$ by $E$ on the left is exactly the
  same as multiplying row 2 by the scalar $k$. We say that $E$ is the
  \textbf{elementary matrix for multiplying row 2 by $k$}.
\end{solution}

\begin{example}{Elementary matrix for adding a multiple of one row to another row}{elementary-matrix-3}
  Let
  \begin{equation*}
    E ~=~ \begin{mymatrix}{lll}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
      0 & k & 1 \\
    \end{mymatrix}.
  \end{equation*}
  What is the effect of multiplying $E$ by an arbitrary $3\times
  n$-matrix $A$?
\end{example}

\begin{solution}
  Once again we compute the product $EA$:
  \begin{equation*}
    EA ~=~ \begin{mymatrix}{lll}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
      0 & k & 1 \\
    \end{mymatrix}
    \begin{mymatrix}{cccc}
      a_{11} & a_{12} & \cdots & a_{1n} \\
      a_{21} & a_{22} & \cdots & a_{2n} \\
      a_{31} & a_{32} & \cdots & a_{3n} \\
    \end{mymatrix}
    ~=~
    \begin{mymatrix}{cccc}
      a_{11} & a_{12} & \cdots & a_{1n} \\
      a_{21} & a_{22} & \cdots & a_{2n} \\
      a_{31}+ka_{21} & a_{32}+ka_{22} & \cdots & a_{3n}+ka_{2n} \\
    \end{mymatrix}.
  \end{equation*}
  So the effect of multiplying $A$ by $E$ on the left is exactly the
  same as adding $k$ times row 2 to row 3. We say that $E$ is the
  \textbf{elementary matrix for adding $k$ times row 2 to row 3}.
\end{solution}

As these examples show, performing each type of elementary row
operation is the same as multiplying (on the left) by a certain
invertible matrix. These matrices are called the \textbf{elementary
  matrices}%
\index{elementary matrix}\index{matrix!elementary matrix}. In the
above examples, we have only considered $3\times 3$-elementary
matrices, but they exist for other sizes too. The following definition
makes this precise. It also shows how to calculate the elementary
matrix corresponding to any elementary row operation.

\begin{definition}{Elementary matrices and row operations}{elementary-matrices-and-row-ops}
  Let $E$ be an $n\times n$-matrix. Then $E$ is an \textbf{elementary
    matrix}%
  \index{elementary matrix}\index{matrix!elementary matrix} if it is
  the result of applying one row operation to the $n\times n$ identity
  matrix.
\end{definition}

\begin{example}{Finding an elementary matrix}{finding-elementary-matrix}
  Consider the elementary row operation of adding $5$ times row 3 to
  row 1 of a $4\times n$-matrix. Find the elementary matrix $E$
  corresponding to this row operation.
\end{example}

\begin{solution}
  Following Definition~\ref{def:elementary-matrices-and-row-ops}, all
  we have to do is apply the desired row operation to the
  $4\times 4$-identity matrix:
  \begin{equation*}
    \begin{mymatrix}{rrrr}
      1 & 0 & 0 & 0 \\
      0 & 1 & 0 & 0 \\
      0 & 0 & 1 & 0 \\
      0 & 0 & 0 & 1 \\
    \end{mymatrix}
    \quad
    \stackrel{R_1\rowop R_1+5R_3}{\roweq}
    \quad
    \begin{mymatrix}{rrrr}
      1 & 0 & 5 & 0 \\
      0 & 1 & 0 & 0 \\
      0 & 0 & 1 & 0 \\
      0 & 0 & 0 & 1 \\
    \end{mymatrix}
    ~=~ E.
  \end{equation*}
\end{solution}

We can double-check that multiplying $E$ by any $4\times n$-matrix
does indeed have the desired effect:
\begin{equation*}
  \begin{mymatrix}{rrrr}
    1 & 0 & 5 & 0 \\
    0 & 1 & 0 & 0 \\
    0 & 0 & 1 & 0 \\
    0 & 0 & 0 & 1 \\
  \end{mymatrix}
  \begin{mymatrix}{cccc}
    a_{11} & a_{12} & \cdots & a_{1n} \\
    a_{21} & a_{22} & \cdots & a_{2n} \\
    a_{31} & a_{32} & \cdots & a_{3n} \\
    a_{41} & a_{42} & \cdots & a_{4n} \\
  \end{mymatrix}
  ~=~
  \begin{mymatrix}{cccc}
    a_{11}+5a_{31} & a_{12}+5a_{32} & \cdots & a_{1n}+5a_{3n} \\
    a_{21} & a_{22} & \cdots & a_{2n} \\
    a_{31} & a_{32} & \cdots & a_{3n} \\
    a_{41} & a_{42} & \cdots & a_{4n} \\
  \end{mymatrix}.
\end{equation*}
The fact that this always works is the content of the following
theorem.

\begin{theorem}{Multiplication by an elementary matrix and row operations}{mult-by-elementary-matrix}
  Performing any of the three row operations on a matrix $A$ is the
  same as taking the product $EA$, where $E$ is the elementary matrix
  obtained by applying the desired row operation to the identity
  matrix.
\end{theorem}

% ----------------------------------------------------------------------
\subsection{Inverses of elementary matrices}

Suppose we have applied a row operation to a matrix $A$. Consider the
row operation required to return $A$ to its original form, i.e., to
undo the row operation. It turns out that this action is described by
the inverse of an elementary matrix. The following theorem ensures
that the inverse of each elementary matrix is itself an elementary
matrix.

\begin{theorem}{Inverses of elementary matrices}{inverse-elementary-matrix}
  Every elementary matrix is invertible and its inverse is also an
  elementary matrix%
  \index{elementary matrix!inverse}%
  \index{matrix!elementary matrix!inverse}.
\end{theorem}

In fact, the inverse of an elementary matrix is constructed by doing
the {\em reverse }row operation on $I$. $E^{-1}$ is obtained by
performing the row operation which would carry $E$ back to $I$.

\begin{itemize}
\item If $E$ is obtained by switching rows $i$ and $j$, then $E^{-1}$
  is also obtained by switching rows $i$ and $j$.
\item If $E$ is obtained by multiplying row $i$ by the scalar $k$,
  then $E^{-1}$ is obtained by multiplying row $i$ by the scalar
  $\frac{1}{k}$.
\item If $E$ is obtained by adding $k$ times row $i$ to row $j$, then
  $E^{-1}$ is obtained by subtracting $k$ times row $i$ from row $j$.
\end{itemize}

\begin{example}{Inverse of an elementary matrix}{inverse-elementary-matrix}
  Find $E^{-1}$, where $E$ is the elementary matrix
  \begin{equation*}
    E
    =
    \begin{mymatrix}{rr}
      1 & 0 \\
      0 & 2
    \end{mymatrix}
  \end{equation*}
\end{example}

\begin{solution}
  $E$ is obtained from the $2\times 2$ identity matrix by multiplying
  the second row by $2$. In order to carry $E$ back to the identity,
  we need to multiply the second row of $E$ by $\frac{1}{2}$.  Hence,
  $E^{-1}$ is given by
  \begin{equation*}
    E^{-1}
    =
    \begin{mymatrix}{rr}
      1 & 0 \\
      0 & \frac{1}{2}
    \end{mymatrix}.
  \end{equation*}
\end{solution}

% ----------------------------------------------------------------------
\subsection{Elementary matrices and {\rref}s}

Suppose an $m\times n$-matrix $A$ is row reduced to its {\rref}. By
tracking each row operation completed, this row reduction can be
performed through multiplication by elementary matrices. The following
theorem uses this fact.

\begin{theorem}{The form $R=UA$}{form-rua}
  Let $A$ be any $m\times n$-matrix and let $R$ be its {\rref}. Then
  there exists an invertible $m\times m$-matrix $U$ such that
  \begin{equation*}
    R=UA.
  \end{equation*}
  Specifically, $U$ can be computed as the product (from right to
  left) of the elementary matrices of all row operations used to
  convert $A$ to {\rref}.
\end{theorem}

\begin{example}{The form $R=UA$}{form-rua}
  Let
  \begin{equation*}
    A = \begin{mymatrix}{rr}
      0 & 1 \\
      1 & 0 \\
      2 & 0
    \end{mymatrix}.
  \end{equation*}
  Find the {\rref} of $A$ and write it in the form $R=UA$, where $U$
  is invertible.
\end{example}

\begin{solution}
  To find the {\rref} $R$, we row reduce $A$. For each step, we will
  record the appropriate elementary matrix. First, switch rows $1$
  and $2$.
  \begin{equation*}
    \begin{mymatrix}{rr}
      0 & 1 \\
      1 & 0 \\
      2 & 0
    \end{mymatrix}
    \quad\stackrel{R_1\rowswap R_2}{\roweq}\quad
    \begin{mymatrix}{rr}
      1 & 0 \\
      0 & 1 \\
      2 & 0
    \end{mymatrix}.
  \end{equation*}
  The corresponding elementary matrix is
  $E_1 = \begin{mymatrix}{rrr}
    0 & 1 & 0 \\
    1 & 0 & 0 \\
    0 & 0 & 1
  \end{mymatrix}$, i.e.,
  \begin{equation*}
    \begin{mymatrix}{rrr}
      0 & 1 & 0 \\
      1 & 0 & 0 \\
      0 & 0 & 1
    \end{mymatrix}
    \begin{mymatrix}{rr}
      0 & 1 \\
      1 & 0 \\
      2 & 0
    \end{mymatrix}
    ~=~\begin{mymatrix}{rr}
      1 & 0 \\
      0 & 1 \\
      2 & 0
    \end{mymatrix}.
  \end{equation*}
  Next, subtract $2$ times the first row from the third row.
  \begin{equation*}
    \begin{mymatrix}{rr}
      1 & 0 \\
      0 & 1 \\
      2 & 0
    \end{mymatrix}
    \quad\stackrel{R_3\rowop R_3-2R_1}{\roweq}\quad
    \begin{mymatrix}{rr}
      1 & 0 \\
      0 & 1 \\
      0 & 0
    \end{mymatrix}.
  \end{equation*}
  The corresponding elementary matrix is
  $E_2 = \begin{mymatrix}{rrr}
    1  & 0 & 0 \\
    0  & 1 & 0 \\
    -2 & 0 & 1
  \end{mymatrix}$, i.e.,
  \begin{equation*}
    \begin{mymatrix}{rrr}
    1  & 0 & 0 \\
    0  & 1 & 0 \\
    -2 & 0 & 1
    \end{mymatrix}
    \begin{mymatrix}{rr}
      1 & 0 \\
      0 & 1 \\
      2 & 0
    \end{mymatrix}
    ~=~\begin{mymatrix}{rr}
      1 & 0 \\
      0 & 1 \\
      0 & 0
    \end{mymatrix}.
  \end{equation*}
  Notice that the resulting matrix is $R$, the required {\rref} of
  $A$. We can then write
  \begin{eqnarray*}
    R &=& E_2E_1A \\
      &=& U A.
  \end{eqnarray*}
  It remains to compute $U$:
  \begin{equation*}
    U ~=~ E_2E_1 ~=~
    \begin{mymatrix}{rrr}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
      -2 & 0 & 1
    \end{mymatrix}
    \begin{mymatrix}{rrr}
      0 & 1 & 0 \\
      1 & 0 & 0 \\
      0 & 0 & 1
    \end{mymatrix} \\
    ~=~ \begin{mymatrix}{rrr}
      0 & 1 & 0\\
      1 & 0 & 0 \\
      0 & -2  & 1
    \end{mymatrix}.
  \end{equation*}
  We can verify that $R = UA$ holds for this matrix $U$:
  \begin{equation*}
    UA ~=~ \begin{mymatrix}{rrr}
      0 & 1 & 0\\
      1 & 0 & 0 \\
      0 & -2  & 1
    \end{mymatrix}
    \begin{mymatrix}{rr}
      0 & 1 \\
      1 & 0 \\
      2 & 0
    \end{mymatrix} \\
    ~=~ \begin{mymatrix}{rr}
      1 & 0 \\
      0 & 1 \\
      0 & 0
    \end{mymatrix} \\
    ~=~ R.
  \end{equation*}
\end{solution}

While the process used in the above example is reliable and simple
when only a few row operations are used, it becomes cumbersome in a
case where many row operations are needed to carry $A$ to $R$. The
following theorem provides an alternate way to find the matrix $U$.

\begin{theorem}{Finding the matrix $U$}{finding-u}
  Let $A$ be an $m\times n$-matrix and let $R$ be its {\rref}. Then
  $R = UA$, where $U$ is an invertible $m \times m$-matrix found by
  forming the augmented matrix $\mat{A\mid I}$ and row reducing to
  $\mat{R\mid U}$.
\end{theorem}

Let's revisit the above example using the process outlined in
Theorem~\ref{thm:finding-u}.

\begin{example}{The form $R=UA$, revisited}{form-rua-revisited}
  Let $A = \begin{mymatrix}{rr}
    0 & 1 \\
    1 & 0 \\
    2 & 0
  \end{mymatrix}$. Use the process of Theorem~\ref{thm:finding-u} to
  find $U$ such that $R=UA$.
\end{example}

\begin{solution}
  First, we set up the augmented matrix $\mat{A\mid I}$:
  \begin{equation*}
    \begin{mymatrix}{rr|rrr}
      0 & 1 & 1 & 0 & 0 \\
      1 & 0 & 0 & 1 & 0 \\
      2 & 0 & 0 & 0 & 1
    \end{mymatrix}.
  \end{equation*}
  Now, we row reduce until the left-hand side is in {\rref}:
  \begin{eqnarray*}
    \begin{mymatrix}{rr|rrr}
      0 & 1 & 1 & 0 & 0 \\
      1 & 0 & 0 & 1 & 0 \\
      2 & 0 & 0 & 0 & 1
    \end{mymatrix}
        &\stackrel{R_1\rowswap R_2}{\roweq}
            &
              \begin{mymatrix}{rr|rrr}
                1 & 0 & 0 & 1 & 0 \\
                0 & 1 & 1 & 0 & 0 \\
                2 & 0 & 0 & 0 & 1
              \end{mymatrix} \\
        &\stackrel{R_3\rowop R_3-2R_1}{\roweq}
            &
              \begin{mymatrix}{rr|rrr}
                1 & 0 & 0 & 1 & 0 \\
                0 & 1 & 1 & 0 & 0 \\
                0 & 0 & 0 & -2 & 1
              \end{mymatrix}.
  \end{eqnarray*}
  The left-hand side of this augmented matrix is $R$, and the
  right-hand side is $U$. Comparing this to the matrices $R$ and $U$
  we found in Example~\ref{exa:form-rua}, we see that the same
  matrices are obtained regardless of which process is used.
\end{solution}

% ----------------------------------------------------------------------
\subsection{Writing an invertible matrix as a product of elementary matrices}

Recall from Algorithm~\ref{algo:matrix-inversion-algorithm} that an
$n\times n$-matrix $A$ is invertible if and only if $A$ can be carried
to the $n\times n$ identity matrix using elementary row
operations. Combining this with our discussion of elementary matrices
we see that $A$ is invertible if and only if it can be written as a
product of elementary matrices. This is the content of the following
theorem.

\begin{theorem}{Product of elementary matrices}{prod-elementary}
  Let $A$ be an $n \times n$-matrix. Then $A$ is invertible if and
  only if it can be written as a product of elementary matrices.
\end{theorem}

\begin{proof}
  If $A$ is an invertible $n\times n$-matrix, then its {\rref} is the
  $n\times n$ identity matrix $I$. By Theorem~\ref{thm:form-rua}, we
  can write $I=UA$, where $U = E_k\cdots E_2E_1$ is a product of
  elementary matrices. Then
  \begin{equation*}
    A ~=~ U^{-1} ~=~ E_1^{-1}E_2^{-1}\cdots E_k^{-1}.
  \end{equation*}
  By Theorem~\ref{thm:inverse-elementary-matrix}, if $E_i$ is an
  elementary matrix, then so is $E_i^{-1}$. Therefore, $A$ has been
  written as a product of elementary matrices. Conversely, if $A$ can
  be written as a product of elementary matrices, then $A$ is clearly
  invertible, because each elementary matrix is invertible.
\end{proof}

\begin{example}{Product of elementary matrices}{prod-elementary}
  Let $A = \begin{mymatrix}{rrr}
    0 &  1 & 0 \\
    1 &  1 & 0 \\
    0 & -2 & 1
  \end{mymatrix}$.
  Write $A$ as a product of elementary matrices.
\end{example}

\begin{solution}
  Following the process of Theorem~\ref{thm:prod-elementary}, we first
  row-reduce $A$ to its {\rref}, recording each row operation as an
  elementary matrix.
  \begin{equation*}
    \begin{mymatrix}{rrr}
      0 & 1 & 0 \\
      1 & 1 & 0 \\
      0 & -2 & 1 \\
    \end{mymatrix}
    \quad\stackrel{R_1\rowswap R_2}{\roweq}\quad
    \begin{mymatrix}{rrr}
      1 & 1 & 0 \\
      0 & 1 & 0 \\
      0 & -2 & 1 \\
    \end{mymatrix}
    \quad\mbox{with elementary matrix}\quad
    E_1 ~=~ \begin{mymatrix}{rrr}
      0 & 1 & 0 \\
      1 & 0 & 0 \\
      0 & 0 & 1
    \end{mymatrix},
  \end{equation*}
  \begin{equation*}
    \begin{mymatrix}{rrr}
      1 & 1 & 0 \\
      0 & 1 & 0 \\
      0 & -2 & 1 \\
    \end{mymatrix}
    \quad\stackrel{R_1\rowop R_1-R_2}{\roweq}\quad
    \begin{mymatrix}{rrr}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
      0 & -2 & 1 \\
    \end{mymatrix}
    \quad\mbox{with elementary matrix}\quad
    E_2 ~=~  \begin{mymatrix}{rrr}
      1 & -1 & 0 \\
      0 & 1 & 0 \\
      0 & 0 & 1
    \end{mymatrix},
  \end{equation*}
  \begin{equation*}
    \begin{mymatrix}{rrr}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
      0 & -2 & 1 \\
    \end{mymatrix}
    \quad\stackrel{R_3\rowop R_3+2R_2}{\roweq}\quad
    \begin{mymatrix}{rrr}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
      0 & 0 & 1 \\
    \end{mymatrix}
    \quad\mbox{with elementary matrix}\quad
    E_3 ~=~ \begin{mymatrix}{rrr}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
      0 & 2 & 1 \\
    \end{mymatrix}.
  \end{equation*}
  Notice that the {\rref} of $A$ is $I$. Hence $I = UA$ where
  $U=E_3E_2E_1$. It follows that
  $A = U^{-1} = E_1^{-1}E_2^{-1}E_3^{-1}$, and so we have succeeded in
  writing $A$ as a product of elementary matrices
  \begin{equation*}
    A
    ~=~ E_1^{-1}E_2^{-1}E_3^{-1}
    ~=~
    \begin{mymatrix}{rrr}
      0 & 1 & 0 \\
      1 & 0 & 0 \\
      0 & 0 & 1
    \end{mymatrix}
    \begin{mymatrix}{rrr}
      1 & 1 & 0 \\
      0 & 1 & 0 \\
      0 & 0 & 1
    \end{mymatrix}
    \begin{mymatrix}{rrr}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
      0 & -2 & 1
    \end{mymatrix}.
  \end{equation*}
  In particular, it follows that $A$ is invertible.
\end{solution}
