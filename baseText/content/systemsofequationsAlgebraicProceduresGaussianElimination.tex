\section{Gaussian Elimination}

In the previous section, we saw examples of how to solve a system of
equations using elementary row operations (and sometimes back
substitution). But it is not clear whether every system of equations
can be solved this way. How do we know which elementary row operation
to apply next? In this section, you will learn a procedure called {\em
  Gaussian elimination} by which every system of linear equations can
be solved systematically.

Before we start, let's figure out what it means to be ``done''. At
what point should we stop performing row operations? The answer is
that we will stop performing row operations when the system of
equations is in a special form called {\em \ef}, which we now define.

\begin{definition}{\EF}{echelonform}
  An entry of an augmented matrix is called a
  \textbf{leading entry}\index{leading entry} or
  \textbf{pivot entry}\index{pivot entry}
  if it is the leftmost nonzero entry of a row. 
  An augmented matrix is in
  \textbf{\ef}\index{\ef}
  (also called \textbf{row echelon form}\index{row echelon form}) if
  \begin{enumerate}
  \item All rows of zeros are below all nonzero rows.
    
  \item Each leading entry of a row is in a column to the right of the
    leading entry of any row above it.
  \end{enumerate}
  A column containing a pivot entry is also called a
  \textbf{pivot column}\index{pivot column}.
\end{definition}

The word {\em echelon} comes from French {\em \'echelle}, which means
ladder. This is because an echelon form looks a bit like a ladder or
staircase. Here are some examples of {\ef}s.


\begin{example}{Matrices in \EF}{matricesnotrref}
  The following augmented matrices are in \ef. We have circled the
  pivot entries for clarity.
  \begin{equation*}
    \leftB
    \begin{array}{rrrrr|r}
      0 & \circled{5} & 2 & 1 & 3 & 5 \\
      0 & 0 & 0 & 0 & \circled{1} & 6 \\
      0 & 0 & 0 & 0 & 0 & 0 \\
      0 & 0 & 0 & 0 & 0 & 0
    \end{array}
    \rightB, \quad \leftB
    \begin{array}{rrrrr|r}
      \circled{1} & 4 & 0 & 0 & 5 & 0 \\
      0 & 0 & \circled{1} & 0 & 2 & 0 \\
      0 & 0 & 0 & \circled{1} & 4 & 0 \\
      0 & 0 & 0 & 0 & 0 & \circled{1}
    \end{array}
    \rightB, \quad \leftB
    \begin{array}{rrr|r}
      \circled{3} & 0 & 6 & 2 \\
      0 & \circled{1} & 4 & 0 \\
      0 & 0 & \circled{2} & 1 \\
      0 &  0 & 0 & 0
    \end{array}
    \rightB
  \end{equation*}
\end{example}

\begin{example}{Not in \EF}{matricesnotechelon}
The following augmented matrices are not in \ef. 

\begin{equation*}
\leftB
\begin{array}{rrr|r}
0 & 0 & 0 & 0 \\
\circled{1} & 2 & 3 & 3 \\
0 & \circled{1} & 0 & 2 \\
0 & 0 & 0 & \circled{1} \\
0 & 0 & 0 & 0
\end{array}
\rightB, \quad \leftB
\begin{array}{rr|r}
\circled{1} & 2 & 3 \\
\circled{2} & 4 & -6 \\
\circled{4} & 0 & 7
\end{array}
\rightB, \quad \leftB
\begin{array}{rrr|r}
0 & \circled{2} & 3 & 3 \\
\circled{1} & 5 & 0 & 2 \\
0 & 0 & \circled{1} & 0 \\
0 & 0 & 0 & 0
\end{array}
\rightB 
\end{equation*}
In the first matrix, a row of zeros is above a nonzero row. In the
second and third matrix, the leading entries of some rows are not to
the right of the leading entries of previous rows.
\end{example}

An augmented matrix can always be converted to {\ef} by using
elementary row operations. The following algorithm shows how to do
this.

\begin{algorithm}{Gaussian Elimination}{gaussianelimination}
  This algorithm provides a method for using row operations to take a
  matrix to its \ef \index{\ef!algorithm}\index{Gaussian elimination}.
  We begin with the matrix in its original form.

  \begin{enumerate}
  \item Starting from the left, find the first nonzero column. This is
    the first pivot column, and the position at the top of this column
    will be the position of the first pivot entry. Switch rows if
    necessary to place a nonzero number in the first pivot position.

  \item Use row operations to make the entries below the first pivot
    entry (in the first pivot column) equal to zero.

    %% Algorithm for the Style B definition of row-echelon form
  \item Ignoring the row containing the first pivot entry, repeat
    steps 1 and 2 with the remaining rows.  Repeat the process until
    there are no more non-zero rows left.

  \end{enumerate}
\end{algorithm}

Most often we will apply this algorithm in order to solve a system of
linear equations. This works by first converting the system to {\ef},
then using back substitution to find the solutions. The next few
examples show how to do this.

\begin{example}{Solving a System of Equations: One Solution}{systemwithonesoln}
  Solve the following system of equations:
  \begin{equation*}
    \begin{array}{r@{~}c@{~}l}
      x+4y+3z &=& 11\\
      2x+10y+7z &=& 27\\
      x+y+2z &=& 5.
    \end{array}
  \end{equation*}
\end{example}

\begin{solution} The augmented matrix for this system is
  \begin{equation*}
    \leftB
    \begin{array}{rrr|r}
      1 & 4 & 3 & 11 \\
      2 & 10 & 7 & 27 \\
      1 & 1 & 2 & 5
    \end{array}
    \rightB.
  \end{equation*}
  In order to find the solution(s) to this system, we first use
  Algorithm~\ref{algo:gaussianelimination} to carry the augmented
  matrix to \ef. Notice that the first column is nonzero, so this is
  our first pivot column. The first entry in the first row, $1$, is
  the first pivot entry. We will use row operations to create zeros in
  the entries below the $1$.
  \begin{equation*}
    \leftB
    \begin{array}{rrr|r}
      \circled{1} & 4 & 3 & 11 \\
      2 & 10 & 7 & 27 \\
      1 & 1 & 2 & 5
    \end{array}
    \rightB
    \stackrel{R_2\leftarrow R_2-2R_1}{\sim}
    \leftB
    \begin{array}{rrr|r}
      \circled{1} & 4 & 3 & 11 \\
      0 & 2 & 1 & 5 \\
      1 & 1 & 2 & 5
    \end{array}
    \rightB
    \stackrel{R_2\leftarrow R_2-R_1}{\sim}
    \leftB
    \begin{array}{rrr|r}
      \circled{1} & 4 & 3 & 11 \\
      0 & 2 & 1 & 5 \\
      0 & -3 & -1 & -6
    \end{array}
    \rightB
  \end{equation*}
  Now the entries in the first column below the pivot position are
  zeros. We now look for the second pivot column, which in this case
  is column two.  Here, the $2$ in the second row and second column is
  in the pivot entry. We could create a zero below the $2$ with a
  single row operation by adding $\frac{3}{2}$ times the second row
  from the third row. But it is sometimes more convenient not to work
  with fractions, and therefore we start instead by multiplying the
  third row by $2$.
  \begin{equation*}
    \leftB
    \begin{array}{rrr|r}
      \circled{1} & 4 & 3 & 11 \\
      0 & \circled{2} & 1 & 5 \\
      0 & -3 & -1 & -6
    \end{array}
    \rightB
    \stackrel{R_3\leftarrow 2R_3}{\sim}
    \leftB
    \begin{array}{rrr|r}
      \circled{1} & 4 & 3 & 11 \\
      0 & \circled{2} & 1 & 5 \\
      0 & -6 & -2 & -12
    \end{array}
    \rightB
    \stackrel{R_3\leftarrow R_3+3R_2}{\sim}
    \leftB
    \begin{array}{rrr|r}
      \circled{1} & 4 & 3 & 11 \\
      0 & \circled{2} & 1 & 5 \\
      0 & 0 & 1 & 3
    \end{array}
    \rightB
  \end{equation*}
  The final matrix is our desired {\ef}.
  \begin{equation}\label{eqn:systemwithonesoln-1}
    \leftB
    \begin{array}{rrr|r}
      \circled{1} & 4 & 3 & 11 \\
      0 & \circled{2} & 1 & 5 \\
      0 & 0 & \circled{1} & 3
    \end{array}
    \rightB
  \end{equation}
  Now we do back substitution to solve for $z$, $y$, and then $x$. The
  last equation of the {\ef} gives us $z=3$. Substituting this into
  the second equation, we get $2y+3=5$, which we can solve for $y$ to
  get $y=1$. Finally, substituting $y=1$ and $z=3$ into the first
  equation, we have $x+4(1)+3(3)=11$, which we can solve to get
  $x=-2$. Therefore we have the solution $(x,y,z)=(-2,1,3)$.

  At this point, it is a good idea to double-check this solution using
  the original equations
  \begin{equation*}
    \begin{array}{r@{~}c@{~}l}
      x+4y+3z &=& 11\\
      2x+10y+7z &=& 27\\
      x+y+2z &=& 5.
    \end{array}
  \end{equation*}
  For example, we can double-check that $(-2)+4(1)+3(3)$ is indeed
  equal to $11$, and similarly for the other two equations.
  Double-checking the solution against the original equations is an
  excellent way to guard against any errors that might have happened
  during the row operations or back substitution.

  Finally, we note that $(x,y,z)=(-2,1,3)$ is the {\em only} solution
  to this system of equations. There cannot be any other solutions,
  because by Theorem~\ref{thm:elementaryoperationsandsolns}, any
  solution of the original system of equations would also have to be a
  solution of {\eqref{eqn:systemwithonesoln-1}}, and the back
  substitution leaves us no choice except $z=3$, $y=1$, and $x=-2$.
\end{solution}

\begin{example}{Solving a System of Equations: No Solution}{systemwithnosoln}
  Solve the following system of equations:
  \begin{equation*}
    \begin{array}{r@{~}c@{~}l}
           y  +2z &=& 2\\
      2x  +y  -2z &=& 3\\
      4x  -y -10z &=& 4.
    \end{array}
  \end{equation*}
\end{example}

\begin{solution} The augmented matrix for this system is
  \begin{equation*}
    \leftB
    \begin{array}{rrr|r}
      0 &  1 &   2 & 2\\
      2 &  1 &  -2 & 3\\
      4 & -1 & -10 & 4      
    \end{array}
    \rightB.
  \end{equation*}
  We use Algorithm~\ref{algo:gaussianelimination} to carry the
  augmented matrix to \ef. The first column is nonzero and will be the
  first pivot column. We switch the first two rows to move a non-zero
  number into the pivot position:
  \begin{equation*}
    \leftB
    \begin{array}{rrr|r}
      \circled{2} &  1 &  -2 & 3\\
      0 &  1 &   2 & 2\\
      4 & -1 & -10 & 4      
    \end{array}
    \rightB.
  \end{equation*}
  To create zeros below the pivot entry, we subtract $2$ times the
  first row from the third row:
  \begin{equation*}
    \leftB
    \begin{array}{rrr|r}
      \circled{2} &  1 &  -2 & 3\\
      0 &  1 &   2 & 2\\
      0 & -3 & -6 & -2      
    \end{array}
    \rightB.
  \end{equation*}
  This finishes the first column. The second pivot column will be
  column two, with the $1$ in the second row and column as the pivot
  entry. We add $3$ times the second row to the third row to create a
  zero below the pivot:
  \begin{equation*}
    \leftB
    \begin{array}{rrr|r}
      \circled{2} &  1 &  -2 & 3\\
      0 &  \circled{1} &   2 & 2\\
      0 & 0 & 0 & \circled{4}
    \end{array}
    \rightB.
  \end{equation*}
  This matrix is in {\ef}. Note that the final pivot entry is on the
  right-hand side. The last row corresponds to the equation
  \begin{equation*}
    0x + 0y + 0z = 4.
  \end{equation*}
  This equation has no solution, because for all $x,y,z$, the
  left-hand size will equal $0$ and not $4$. Therefore, there is no
  solution to the given system of equations. In other words, the
  system is inconsistent.
\end{solution}

\begin{example}{Solving a System of Equations: An Infinite Set of Solutions}{infinitesetofsoln}
  Solve the following system of equations:
  \begin{equation}
    \begin{array}{r@{~}c@{~}l}
      x  -y  +5z &=&  2 \\
           y -10z &=& 1 \\
      2x -1y      &=& 5.
    \end{array}
  \end{equation}
\end{example}

\begin{solution} The augmented matrix of this system is
  \begin{equation*}
    \leftB
    \begin{array}{rrr|r}
      1 &  -1  &  5 & 2 \\
      0 &   1 & -10 & 1 \\
      2 &  -1  &  0 & 5
    \end{array}
    \rightB.
  \end{equation*}
  We use Gaussian elimination to carry the augmented matrix to
  {\ef}. The first column is the first pivot column, and $1$ is the
  pivot entry. We use row operating to create zeros beneath the pivot
  entry. We subtract $2$ times the first row from the second row and get:
  \begin{equation*}
    \leftB
    \begin{array}{rrr|r}
      \circled{1} &  -1  &  5 & 2 \\
      0 &   1 & -10 & 1 \\
      0 &   1 & -10 & 1
    \end{array}
    \rightB 
  \end{equation*}
  Now, we have created zeros beneath the pivot entry in the first
  column, so we move on to the second pivot column (which is the
  second column) and repeat the procedure. Subtracing the second row
  from the third row, we get:
  \begin{equation*}
    \leftB
    \begin{array}{rrr|r}
      \circled{1} &  -1  &  5 & 2 \\
      0 &   \circled{1} & -10 & 1 \\
      0 &   0 & 0 & 0
    \end{array}
    \rightB
  \end{equation*}
  This matrix is now in {\ef}. Observe that the first two columns are
  pivot columns, and the third column is not. We call the
  corresponding variables $x$ and $y$
  \textbf{pivot variables}\index{pivot variable}\index{variable!pivot},
  and the variable $z$ is a
  \textbf{free variable}\index{free variable}\index{variable!free}.
  The equations corresponding to
  this {\ef} are
  \[
    \begin{array}{r@{~}c@{~}l}
      x - y + 5z &=& 2 \\
      y - 10z &=& 1. 
    \end{array}
  \]
  Observe that the free variable $z$ is not constrained by any
  equation. In fact, $z$ can equal any number. We choose $t$ to be any
  number and let $z = t$.  In this context $t$ is called a
  \textbf{parameter}\index{parameter}. We then use back substitution
  to solve for the pivot variables $y$ and $x$. From the second
  equation, we have $y = 1+10z = 1+10t$. From the first equation, we
  have $x = 2+y-5z = 2+(1+10t)-5t = 3+5t$. Therefore, the general
  solution of this system is
  \[
    \begin{array}{l}
      x=3+5t \\
      y=1+10t \\
      z=t,
    \end{array}
  \]
  where $t$ is arbitrary. The system has an infinite set of solutions
  which are given by these equations. For any value of the parameter
  $t$ we select, $x$, $y$, and $z$ will be given by the above
  equations. For example, if we choose $t=4$ then the corresponding
  solution would be
  \[
    \begin{array}{l}
      x = 3 + 5(4) = 23\\
      y = 1+10(4) = 41 \\
      z = 4.
    \end{array}
  \]
\end{solution}

In Example \ref{exa:infinitesetofsoln} the solution involved a
parameter. It may happen that the solution to a system involves more
than one parameter, as shown in the following example.

\begin{example}{Solving a System of Equations: A Two Parameter Set of
    Solutions}{twoparametersetofsoln}
  Solve the following system of equations:
  \begin{equation*}
    \begin{array}{r@{~}c@{~}l}
      x +2y  -2z  +2w &=& 3 \\
      x +2y  -z   +3w &=& 5 \\
      x +2y  -3z  +1w &=& 1.
    \end{array}
  \end{equation*}
\end{example}

\begin{solution} The augmented matrix is
  \begin{equation*}
    \leftB
    \begin{array}{rrrr|r}
      1 & 2 & -2 & 2 & 3 \\
      1 & 2 & -1 & 3 & 5 \\
      1 & 2 & -3 & 1 & 1
    \end{array}
    \rightB.
  \end{equation*}
  We carry this matrix to {\ef} using row operations.
  \begin{equation*}
    \leftB
    \begin{array}{rrrr|r}
      1 & 2 & -2 & 2 & 3 \\
      1 & 2 & -1 & 3 & 5 \\
      1 & 2 & -3 & 1 & 1
    \end{array}
    \rightB
    \stackrel{R_2\leftarrow R_2-R_1}{\stackrel{R_3\leftarrow R_3-R_1}{\sim}}
    \leftB
    \begin{array}{rrrr|r}
      \circled{1} & 2 & -2 & 2 & 3 \\
      0 & 0 & 1 & 1 & 2 \\
      0 & 0 & -1 & -1 & -2
    \end{array}
    \rightB
    \stackrel{R_3\leftarrow R_3+R_2}{\sim}
    \leftB
    \begin{array}{rrrr|r}
      \circled{1} & 2 & -2 & 2 & 3 \\
      0 & 0 & \circled{1} & 1 & 2 \\
      0 & 0 & 0 & 0 & 0
    \end{array}
    \rightB.
  \end{equation*}
  This matrix is in {\ef} and we can see that the first and third
  columns are pivot columns, whereas the second and fourth columns are
  not. Therefore, $x$ and $z$ are pivot variables and $y$ and $w$ are
  free variables. We assign parameters $y=s$ and $w=t$ to the free
  variables. Then we do back substitution to solve for $z$ and $x$.
  From the second equation, we have $z=2-w=2-t$. From the first
  equation, we have $x=3-2y+2z-2w = 3-2s+2(2-t)-2t =
  7-2s-4t$. Therefore, the general solution is given by
  \begin{equation*}
    \begin{array}{l}
      x=7-2s-4t \\
      y=s \\
      z=2-t \\
      w=t.
    \end{array}
  \end{equation*}
  It is customary to write this solution in the form
  \begin{equation}\label{twoparameters2}
    \leftB
    \begin{array}{c}
      x \\
      y \\
      z \\
      w
    \end{array}
    \rightB =\leftB
    \begin{array}{c}
      7-2s-4t \\
      s \\
      2-t \\
      t
    \end{array}
    \rightB.
  \end{equation}
\end{solution}

%%% ####### CONTINUE HERE

This example shows a system of equations with an infinite solution set which depends on two parameters. 
It can be less confusing in the case of an infinite solution set to first
place the augmented matrix in \rref \;rather than just
\ef \;before seeking to write down the description of the solution.

In the above steps, this means we don't stop with the \ef \;in equation \ref{twoparameters1}.
Instead we first place it in \rref \;as follows.
\begin{equation*}
\leftB
\begin{array}{rrrr|r}
1 & 0 & -1 & 1 & -1 \\
0 & 1 & 0 & 0 & 2 \\
0 & 0 & 0 & 0 & 0
\end{array}
\rightB 
\end{equation*}
Then the solution is $y=2$ from the second row and $x=-1+z-w$ from the
first. Thus letting $z=s$ and $w=t,$ the solution is given by \ref{twoparameters2}. 

You can see here that there are two paths to the correct answer, which both yield the
same answer. Hence, either approach may be used. The process which we first used in the above solution is called \textbf{Gaussian Elimination} 
\index{Gaussian Elimination}
This process involves carrying the matrix to \ef, converting back to equations, and using back substitution to find the solution. 
When you do row operations until you obtain \rref, the process is
called \textbf{Gauss-Jordan Elimination}. \index{Gauss-Jordan Elimination}

We have now found solutions for systems of equations with no solution and infinitely many solutions, with one parameter as well as two parameters. 
Recall the three types of solution sets which we discussed in the previous section; no solution, one solution, and infinitely many solutions. Each of these
types of solutions could be identified from the graph of the system. It turns out that we can also identify the type of solution
from the \rref \;of the augmented matrix.

\begin{itemize}
\item {\em No Solution: \em}
In the case where the system of equations has no solution, the \ef \; of the augmented matrix will have a row of the form 
\[
\leftB
\begin{array}{rrrrr}
0 & 0 & 0 & | & 1
\end{array}
\rightB
\]

This row indicates that the system is inconsistent and has no solution.

\item {\em One Solution: \em}
In the case where the system of equations has one solution, every column
of the coefficient matrix is a pivot column. 
The following is an example of an augmented matrix in \rref \hspace{0.5mm} for a system of equations with one solution. 
\begin{equation*}
\leftB
\begin{array}{rrr|r}
1 & 0 & 0 & 5 \\
0 & 1 & 0 & 0 \\ 
0 & 0 & 1 & 2 
\end{array}
\rightB
\end{equation*}

\item {\em Infinitely Many Solutions: \em} 
In the case where the system of equations has infinitely many solutions, the solution contains parameters. There
will be columns of the coefficient matrix which are not pivot columns.
The following are examples of augmented matrices in \rref \;for systems of equations with infinitely many solutions. 
\begin{equation*}
\leftB
\begin{array}{rrr|r}
1 & 0 & 0 & 5 \\
0 & 1 & 2 & -3 \\ 
0 & 0 & 0 & 0 
\end{array}
\rightB
\end{equation*}
or
\begin{equation*}
\leftB
\begin{array}{rrr|r}
1 & 0 & 0 & 5 \\
0 & 1 & 0 & -3
\end{array}
\rightB
\end{equation*}

\end{itemize}

% ======================================================================




%%For Style B:
We also consider another reduced form of the augmented matrix which has one further condition. 

%%For Original Kuttler:
%% We also consider another reduced form of the augmented matrix which has further conditions.

\begin{definition}{\RREF}{rref}
An augmented 
\index{\rref} matrix is in \textbf{\rref } if

\begin{enumerate}
\item All nonzero rows are above any rows of zeros.

\item Each leading entry of a row is in a column to the right of the leading
entries of any rows above it.

\item Each leading entry of a row is equal to $1$.

\item All entries in a column above and below a leading entry are zero.

\end{enumerate}
\end{definition}

%%For Style B definition:
Notice that the first three conditions on a \rref  \; matrix are the same as those for \ef. 


%%For original Kuttler definition:
%%Notice that the first two conditions on a \rref  \; matrix are the same as those for \ef.

Hence, every \rref \;matrix is also in \ef. The converse is not necessarily true;
 we cannot assume that every matrix in \ef \;is also in \rref. However, it often happens
that the \ef \;is sufficient to provide information about the solution of a system.

Notice that we could apply further row operations to these matrices to carry them to \rref. Take the time to try that on your own. 
Consider the following matrices, which are in \rref. 

\begin{example}{Matrices in\RREF}{rrefmatrices}
The following augmented matrices are in \rref.
\begin{equation*}
\leftB
\begin{array}{rrrrr|r}
1 & 0 & 0 & 5 & 0 & 0 \\
0 & 0 & 1 & 2 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 & 1 \\
0 & 0 & 0 & 0 & 0 & 0
\end{array}
\rightB ,\leftB
\begin{array}{rrr|r}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 \\
0 & 0 & 0 & 0
\end{array}
\rightB , \leftB
\begin{array}{rrr|r}
1 & 0 & 0 & 4 \\
0 & 1 & 0 & 3 \\
0 & 0 & 1 & 2 
\end{array}
\rightB
\end{equation*}
\end{example}

