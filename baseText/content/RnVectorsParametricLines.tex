\chapter{Lines and planes in \texorpdfstring{$\R^{n}$}{Rn}}

\section{Parametric lines}

\begin{outcome}
  \begin{enumerate}
  \item[A.] Find the vector, parametric, and symmetric equations of a line.
  \item[B.] Determine whether a point is on a given line.
  \item[C.] Determine whether two lines intersect.
  \item[D.] Find the angle between two lines.
  \item[E.] Find the projection of a point onto a line.
  \end{enumerate}
\end{outcome}

We can use the concept of vectors and points to find equations for
lines in $\R^n$. Consider a straight line $L$ that passes through a
point $P$ in the direction given by a non-zero vector $\vect{d}$.
\begin{center}
  \begin{tikzpicture}[rotate=10]
    % Note: I deliberately made the red a bit lighter and the blue a bit
    % darker, so that it will also look okay in black-and-white.
    \draw[red!80](-4,0) -- node [above=3pt, pos=0.875] {$L$} (9,0);
    \draw[->,thick,blue!80!black](0,0) -- node[above left] {$\vect{d}$} (2,0);
    \fill (0,0) circle [radius=2.2pt] node [above=3pt] {$P$};
    \fill (5,0) circle [radius=2.2pt] node [above=3pt] {$Q$};
  \end{tikzpicture}
\end{center}
The line $L$ is infinitely long in both directions, although the
picture only shows a finite part of it. To find an equation for this
line, suppose that $Q$ is an arbitrary point on $L$. Then the vector
$\longvect{PQ}$ is parallel to $\vect{d}$. In other words, there
exists some real number $t$ such that
\begin{equation*}
  \longvect{PQ} = t\,\vect{d}.
\end{equation*}
If $\vect{p}$ is the position vector of $P$ and $\vect{q}$ is the
position vector of $Q$, we can write
\begin{equation*}
  \longvect{PQ} = \vect{q}-\vect{p}.
\end{equation*}
Putting together the last two equations, we get $\vect{q}-\vect{p} =
t\,\vect{d}$, which we can write as
\begin{equation*}
  \vect{q} = \vect{p} + t\,\vect{d}.
\end{equation*}
This is called the \textbf{vector equation}%
\index{vector equation of a line}\index{line!vector equation} of the
line $L$. The vector $\vect{d}$ is called the \textbf{direction
  vector}%
\index{direction vector}\index{vector!direction vector}, and $t$ is
called a \textbf{parameter}\index{parameter}. The parameter $t$ can be
any real number; each time we plug in a different number for $t$, we
get a different point $Q$ on the line. The following picture shows the
effect of the parameter:
\begin{center}
  \begin{tikzpicture}[rotate=10]
    % Note: I deliberately made the red a bit lighter and the blue a bit
    % darker, so that it will also look okay in black-and-white.
    \draw[red!80](-4,0) -- node [above=3pt, pos=0.92] {$L$} (10,0);
    \draw[->,thick,blue!80!black](0,0) -- node[above=3pt] {$\vect{d}$} (2,0);
    \fill (0,0) circle [radius=2.2pt] node [above=3pt] {$P$};
    \fill (-2,0) circle [radius=2.2pt] node [below=9pt] {$t=-1$};
    \fill (0,0) circle [radius=2.2pt] node [below=10pt] {$t=0$};
    \fill (2,0) circle [radius=2.2pt] node [below=10pt] {$t=1$};
    \fill (4,0) circle [radius=2.2pt] node [below=10pt] {$t=2$};
    \fill (6,0) circle [radius=2.2pt] node [below=10pt] {$t=3$};
    \fill (8,0) circle [radius=2.2pt] node [below=10pt] {$t=3$};
  \end{tikzpicture}
\end{center}
The following definition summarizes the above.

\begin{definition}{Vector equation of a line}{vector-equation-of-line}
  Let $\vect{p}$ be a vector and $\vect{d}$ a non-zero vector. Then
  \begin{equation*}
    \vect{q} = \vect{p} + t\,\vect{d}
  \end{equation*}
  is the \textbf{vector equation}%
  \index{vector equation of a line}\index{line!vector equation} of a
  straight line $L$. Specifically, as the parameter $t$ ranges over
  the real numbers, $\vect{q}$ ranges over the position vectors of all
  the points $Q$ on the line $L$.  The vector $\vect{d}$ is called the
  \textbf{direction vector}%
  \index{direction vector}\index{vector!direction vector} of the line.
\end{definition} 

\begin{example}{A line from a point and a direction vector}{line-point-and-direction-vector}
  Find a vector equation for the line which contains the point
  $P = \tup{2,0,3}$ and has direction vector
  $\vect{d} = \mat{1,2,1}^T$.
\end{example}

\begin{solution}
  The position vector of the point $P$ is
  $\vect{p}=\mat{2,0,3}^T$. The equation of the line is
  $\vect{q}= \vect{p} + t\,\vect{d}$, which we can write as
  \begin{equation*}
    \begin{mymatrix}{c} x \\ y \\ z \end{mymatrix}
    = \begin{mymatrix}{c} 2 \\ 0 \\ 3 \end{mymatrix}
    + t \begin{mymatrix}{c} 1 \\ 2 \\ 1 \end{mymatrix}.
  \end{equation*}
\end{solution}

\begin{example}{A line from two points}{line-from-two-points}
  Find a vector equation for the line through the points
  $P = \tup{1,2,0,1}$ and $R = \tup{2,-4,6,3}$.
\end{example}

\begin{solution}
  We can use $P$ as the base point; its position vector is
  $\vect{p}=\mat{1,2,0,1}^T$. We can use
  $\vect{d}=\longvect{PR}=\mat{1,-6,6,2}$ as the direction vector. Then
  a vector equation of the line is
  $\vect{q} = \vect{p} + t\,\vect{d}$,
  which we can also write as
  \begin{equation*}
    \begin{mymatrix}{c} x \\ y \\ z \\ w \end{mymatrix}
    = \begin{mymatrix}{c} 1 \\ 2 \\ 0 \\ 1\end{mymatrix}
    + t \begin{mymatrix}{r} 1 \\ -6 \\ 6 \\ 2\end{mymatrix}.
  \end{equation*}
\end{solution} 

When we write a vector equation in the form
\begin{equation*}
  \begin{mymatrix}{c} x_1 \\ x_2 \\ \vdots \\ x_n \end{mymatrix}
  = \begin{mymatrix}{c} p_1 \\ p_2 \\ \vdots \\ p_n \end{mymatrix}
  + t \begin{mymatrix}{r} d_1 \\ d_2 \\ \vdots \\ d_n \end{mymatrix},
\end{equation*}
it is also called the \textbf{component form}%
\index{vector equation of a line!component form}%
\index{component form}\index{line!component form}
of the vector equation.

Notice that the vector equation of a line is not unique. In fact,
there are infinitely many vector equations for the same line. For
example, we can replace the parameter $t$ with another parameter, say
$3s$ or $1-r$.

\begin{example}{Change of parameter}{change-of-parameter}
  Consider the vector equation from
  Example~\ref{exa:line-point-and-direction-vector},
  \begin{equation*}
    \begin{mymatrix}{c} x \\ y \\ z \end{mymatrix}
    = \begin{mymatrix}{c} 2 \\ 0 \\ 3 \end{mymatrix}
    + t \begin{mymatrix}{c} 1 \\ 2 \\ 1 \end{mymatrix}.
  \end{equation*}
  Find two other equations for the same line, by changing the
  parameter to $3s$ and to $1-r$.
\end{example}

\begin{solution}
  If we let $t=3s$, we get
  \begin{equation*}
    \begin{array}{rcl}
      \begin{mymatrix}{c} x \\ y \\ z \end{mymatrix}
      &=& \begin{mymatrix}{c} 2 \\ 0 \\ 3 \end{mymatrix}
      + 3s \begin{mymatrix}{c} 1 \\ 2 \\ 1 \end{mymatrix}\\\\[-1ex]
      &=& \begin{mymatrix}{c} 2 \\ 0 \\ 3 \end{mymatrix}
      + s \begin{mymatrix}{c} 3 \\ 6 \\ 3 \end{mymatrix}.
    \end{array}
  \end{equation*}
  If we let $t=1-r$, we get
  \begin{equation*}
    \begin{array}{rcl}
      \begin{mymatrix}{c} x \\ y \\ z \end{mymatrix}
      &=& \begin{mymatrix}{c} 2 \\ 0 \\ 3 \end{mymatrix}
      + (1-r) \begin{mymatrix}{c} 1 \\ 2 \\ 1 \end{mymatrix}\\\\[-1ex]
      &=& \begin{mymatrix}{c} 2 \\ 0 \\ 3 \end{mymatrix}
      + \begin{mymatrix}{c} 1 \\ 2 \\ 1 \end{mymatrix}
      - r \begin{mymatrix}{c} 1 \\ 2 \\ 1 \end{mymatrix}\\\\[-1ex]
      &=& \begin{mymatrix}{c} 3 \\ 2 \\ 4 \end{mymatrix}
      + r \begin{mymatrix}{c} -1 \\ -2 \\ -1 \end{mymatrix}.
    \end{array}
  \end{equation*}
\end{solution}

\begin{definition}{Parametric equations of a line}{parametric-equations}
  A line with vector equation
  \begin{equation*}
    \begin{mymatrix}{c} x_1 \\ x_2 \\ \vdots \\ x_n \end{mymatrix}
    = \begin{mymatrix}{c} p_1 \\ p_2 \\ \vdots \\ p_n \end{mymatrix}
    + t \begin{mymatrix}{r} d_1 \\ d_2 \\ \vdots \\ d_n \end{mymatrix}
  \end{equation*}
  can also be written as a set of $n$ scalar equations:
  \begin{equation*}
    \begin{array}{c@{~}c@{~}c}
      x_1 &=& p_1 + t\,d_1, \\
      x_2 &=& p_2 + t\,d_2, \\
          &\vdots&             \\
      x_n &=& p_n + t\,d_n,
    \end{array}
  \end{equation*}
  When written in this form, they are called the \textbf{parametric
    equations}%
  \index{parametric equations of a line}\index{line!parametric
    equations} of the line.
\end{definition}

\begin{example}{Parametric equations}{parametric-equation}
  Find parametric equations for the line through the points
  $P = \tup{1,2,0,1}$ and $R = \tup{2,-4,6,3}$.
\end{example}

\begin{solution}
  This is a same line as in Example~\ref{exa:line-from-two-points}. We
  can easily convert the vector equation
  \begin{equation*}
    \begin{mymatrix}{c} x \\ y \\ z \\ w \end{mymatrix}
    = \begin{mymatrix}{c} 1 \\ 2 \\ 0 \\ 1\end{mymatrix}
    + t \begin{mymatrix}{r} 1 \\ -6 \\ 6 \\ 2\end{mymatrix}
  \end{equation*}
  to a set of parametric equations:
  \begin{equation*}
    \begin{array}{c@{~}c@{~}l}
      x &=& 1 + t, \\
      y &=& 2 - 6t, \\
      z &=& 6t, \\
      w &=& 1 + 2t.
    \end{array}
  \end{equation*}
\end{solution}

\begin{example}{Determine whether a point is on a line}{point-on-line}
  Determine whether the point $P=(5,8,4)$ is on the line $L$ given by
  the vector equation
  \begin{equation*}
    \begin{mymatrix}{c} x \\ y \\ z \end{mymatrix}
    = \begin{mymatrix}{c} 1 \\ 2 \\ 1 \end{mymatrix}
    + t \begin{mymatrix}{c} 2 \\ 3 \\ 1 \end{mymatrix}.
  \end{equation*}
\end{example}

\begin{solution}
  The point $P$ is on the line $L$ if and only if there exists some
  $t\in\R$ such that 
  \begin{equation*}
    \begin{mymatrix}{c} 1 \\ 2 \\ 1 \end{mymatrix}
    + t \begin{mymatrix}{c} 2 \\ 3 \\ 1 \end{mymatrix}
    = \begin{mymatrix}{c} 5 \\ 8 \\ 4 \end{mymatrix}.
  \end{equation*}
  Subtracting $\mat{1,2,1}^T$ from both sides of the equation, this is
  equivalent to
  \begin{equation*}
    t \begin{mymatrix}{c} 2 \\ 3 \\ 1 \end{mymatrix}
    = \begin{mymatrix}{c} 4 \\ 6 \\ 3 \end{mymatrix}.
  \end{equation*}
  We can write this as a set of parametric equations:
  \begin{equation*}
    \begin{array}{c@{~}c@{~}l}
      2t &=& 4, \\
      3t &=& 6, \\
      t &=& 3.
    \end{array}
  \end{equation*}
  This is a system of three linear equations in one variable, and we
  quickly see that it is inconsistent. Therefore, the point $P$ does
  not lie on the line $L$.
\end{solution}

\begin{example}{Determine whether two lines intersect}{lines-intersect}
  Determine whether the lines
  \begin{equation*}
    \begin{mymatrix}{c} x \\ y \\ z \end{mymatrix}
    = \begin{mymatrix}{c} 3 \\ 1 \\ 0 \end{mymatrix}
    + t \begin{mymatrix}{c} 2 \\ 0 \\ 1 \end{mymatrix}
    \quad\mbox{and}\quad
    \begin{mymatrix}{c} x \\ y \\ z \end{mymatrix}
    = \begin{mymatrix}{c} 1 \\ -1 \\ 5 \end{mymatrix}
    + s \begin{mymatrix}{c} 2 \\ 1 \\ -2 \end{mymatrix}
  \end{equation*}
  intersect. If yes, find the point of intersection.
\end{example}

\begin{solution}
  The two lines intersect if and only if there exist $t,s\in\R$ such
  that
  \begin{equation*}
    \begin{mymatrix}{c} 3 \\ 1 \\ 0 \end{mymatrix}
    + t \begin{mymatrix}{c} 2 \\ 0 \\ 1 \end{mymatrix}
    = \begin{mymatrix}{c} 1 \\ -1 \\ 5 \end{mymatrix}
    + s \begin{mymatrix}{c} 2 \\ 1 \\ -2 \end{mymatrix}.
  \end{equation*}
  Bringing $s$ to the left-hand side, and subtracting $\mat{3,1,0}^T$
  from both sides of the equation, this is equivalent to
  \begin{equation*}
    t \begin{mymatrix}{c} 2 \\ 0 \\ 1 \end{mymatrix}
    - s \begin{mymatrix}{c} 2 \\ 1 \\ -2 \end{mymatrix}
    = \begin{mymatrix}{c} -2 \\ -2 \\ 5 \end{mymatrix}.
  \end{equation*}
  If we write this vector equation as a set of three parametric
  equations, it is a system of 3 linear equations in 2 variables. The
  augmented matrix of the system is
  \begin{equation*}
    \begin{mymatrix}{cc|c}
      2 & -2 & -2 \\
      0 & -1 & -2 \\
      1 & 2 & 5   \\
    \end{mymatrix}.
  \end{equation*}
  This system has reduced echelon form
  \begin{equation*}
    \begin{mymatrix}{cc|c}
      1 & 0 & 1 \\
      0 & 1 & 2 \\
      0 & 0 & 0 \\
    \end{mymatrix},
  \end{equation*}
  and has the unique solution $t=1$ and $s=2$. Therefore, the lines
  intersect. (If the lines had not intersected, the system of
  equations would have been inconsistent). We find the point of
  intersection by plugging the parameter $t=1$ into the equation of
  the first line (or equivalently, but plugging $s=2$ into the
  equation of the second line - doing it both ways is a good way to
  double-check your answer). Therefore, the point of intersection is
  \begin{equation*}
    \begin{mymatrix}{c} 3 \\ 1 \\ 0 \end{mymatrix}
    + 1 \begin{mymatrix}{c} 2 \\ 0 \\ 1 \end{mymatrix}
    = \begin{mymatrix}{c} 5 \\ 1 \\ 1 \end{mymatrix}.
  \end{equation*}
\end{solution}

There is one other form for a line which is useful, which is the
\textbf{symmetric form}.  Consider the line given by
\begin{equation*}
  \begin{array}{c@{~}c@{~}l}
    x &=& 1 + 2t, \\
    y &=& 1 - t, \\
    z &=& 3 + 2t. \\
  \end{array}
\end{equation*}
We can solve each equation for $t$:
\begin{equation*}
  \begin{array}{c@{~}c@{~}l}
    t &=& \frac{x-1}{2}, \\\\[-2ex]
    t &=& \frac{y-1}{-1}, \\\\[-2ex]
    t &=& \frac{z-3}{2}.
  \end{array}
\end{equation*}
Finally, we can eliminate $t$ from the equations by setting all three
equations equal to one another:
\begin{equation*}
  \frac{x-1}{2} = \frac{y-1}{-1} = \frac{z-3}{2}.
\end{equation*}
The latter is really a system of 2 equations in 3 variables.  This is
the \textbf{symmetric form}%
\index{line!symmetric form equation}\index{symmetric form} of the
equation of the line.  In the following example, we look at how to
convert the equation of a line from symmetric form to parametric form.

\begin{example}{Change symmetric form to parametric form}{symmetric-to-parametric}
  Consider the line whose equations are given in \textbf{symmetric form} as
  \begin{equation*}
    \frac{x-2}{3}=\frac{y-1}{2}=\frac{z+3}{1}.
  \end{equation*}
  Find parametric and vector equations for this line.
\end{example}

\begin{solution}
  We set all three quantities equal to $t$:
  \begin{equation*}
    t=\frac{x-2}{3}, \quad
    t=\frac{y-1}{2}, \quad
    t=\frac{z+3}{1}.
  \end{equation*}
  Solving these equations for $x,y,z$ yields
  \begin{equation*}
    \begin{array}{c}
      x = 2 + 3t, \\
      y = 1 + 2t, \\
      z = -3 + t.
    \end{array}
  \end{equation*}
  These are the parametric equations for the line. The vector equation
  is
  \begin{equation*}
    \begin{mymatrix}{c}
      x \\
      y \\
      z
    \end{mymatrix} =
    \begin{mymatrix}{r}
      2 \\
      1 \\
      -3 
    \end{mymatrix}
    +
    t
    \begin{mymatrix}{r}
      3 \\
      2 \\
      1 
    \end{mymatrix}.
  \end{equation*}
\end{solution}

% ---------------------------------------------------------------------
% ### CONTINUE HERE

\subsection{Stuff... CONTINUE HERE}

Another application of the geometric description of the dot product is
in finding the angle between two lines. Typically one would assume that the
lines intersect. In some situations, however, it may make sense to ask this
question when the lines do not intersect, such as the angle between
two object trajectories. In any case we understand it to mean the
smallest angle between (any of) their direction vectors. The only
subtlety here is that if $\vect{u}$ is a direction vector for a line,
then so is any multiple $k\vect{u}$, and thus we will find complementary angles
among all angles between direction vectors for two lines, and we
simply take the smaller of the two.

\begin{example}{Find the angle between two lines}{angle-between-two-lines}
Find the angle between the two lines
\begin{equation*}
L_1:  \;
\begin{mymatrix}{r}
x \\
y \\
z 
\end{mymatrix}
 = 
\begin{mymatrix}{r}
1 \\
2 \\
0
\end{mymatrix} +t\begin{mymatrix}{r}
-1 \\
1 \\
2
\end{mymatrix} 
\end{equation*}
 and
\begin{equation*}
L_2: \;
\begin{mymatrix}{r}
x \\
y \\
z
\end{mymatrix}
 = 
\begin{mymatrix}{r}
0 \\
4 \\
-3
\end{mymatrix}
 +s\begin{mymatrix}{r}
2 \\
1 \\
-1
\end{mymatrix}
\end{equation*}
\end{example}

\begin{solution}
You can verify that these lines do not intersect, but as discussed
above this does not matter and we simply find the smallest angle
between any directions vectors for these lines.

To do so  we first find the angle
between the direction vectors given above:
\begin{equation*}
\vect{u}=\begin{mymatrix}{r}
-1 \\
1 \\
2
\end{mymatrix},\;
\vect{v}=\begin{mymatrix}{r}
2 \\
1 \\
-1
\end{mymatrix}
\end{equation*}

In order to find the angle, we solve the following equation for $\theta$
\begin{equation*}
\vect{u}\dotprod \vect{v}=\norm{\vect{u}} \norm{\vect{v}
} \cos \theta
\end{equation*}
to obtain $\cos \theta = -\frac{1}{2}$ and since we choose included
angles between $0$ and $\pi$ we obtain $\theta = \frac{2 \pi}{3}$.


Now the angles between any two direction vectors for these lines will
either be $\frac{2 \pi}{3}$ or its complement $ \phi = \pi -  \frac{2 \pi}{3}
= \frac{\pi}{3}$. We choose the smaller angle, and therefore conclude that the angle between the two lines is $\frac{\pi}{3}$.
\end{solution}

% ----------------------------------------------------------------------

We will conclude this section with an important application of projections. Suppose a line $L$ and a point $P$ are given such that $P$ is not contained in $L$. Through the use of projections, we can determine the shortest distance from $P$ to $L$. 

\begin{example}{Shortest distance from a point to a line}{shortest-point-line}
Let $P = (1,3,5)$ be a point in $\R^3$, and let $L$ be the line which goes through point $P_0 = (0,4,-2)$ with direction vector $\vect{d} = \begin{mymatrix}{r}
2 \\
1 \\
2
\end{mymatrix}
$.  Find the shortest distance from $P$ to the line $L$, and find the point $Q$ on $L$ that is closest to $P$. 
\end{example}

\begin{solution}
In order to determine the shortest distance from $P$ to $L$, we will first find the vector $\longvect{P_0P}$ and then find the projection of this vector onto $L$. 
The vector $\longvect{P_0P}$ is given by 
\[
\longvect{P_0P}=
\begin{mymatrix}{r}
1 \\
3 \\
5
\end{mymatrix}
-
\begin{mymatrix}{r}
0 \\
4 \\
-2
\end{mymatrix}
 = \begin{mymatrix}{r}
1 \\
-1 \\
7
\end{mymatrix}
\]

Then, if $Q$ is the point on $L$ closest to $P$, it follows that 
\begin{eqnarray*}
\longvect{P_0Q} &=& \func{proj}_{\vect{d}}\longvect{P_0P} \\
&=& \tup{\frac{ \longvect{P_0P}\bullet \vect{d}}{\norm{\vect{d}}^2}} \vect{d} \\
&=& 
\frac{15}{9} \begin{mymatrix}{r}
2 \\
1 \\
2
\end{mymatrix} \\
&=&
\frac{5}{3} \begin{mymatrix}{r}
2 \\
1 \\
2
\end{mymatrix}
\end{eqnarray*}

Now, the distance from $P$ to $L$ is given by 
\[
\norm{\longvect{QP}} = \norm{\longvect{P_0P} - \longvect{P_0Q}}
 = \sqrt{26} 
\]

The point $Q$ is found by adding the vector $\longvect{P_0Q}$ to the position vector $\longvect{0P_0}$ for $P_0$ as follows
\begin{eqnarray*}
\begin{mymatrix}{r}
0 \\
4 \\
-2
\end{mymatrix}
+
\frac{5}{3}
\begin{mymatrix}{r}
2 \\
1 \\
2
\end{mymatrix} 
&=& 
\begin{mymatrix}{r}
\vspace{0.05in}\frac{10}{3} \\
\vspace{0.05in}\frac{17}{3} \\
\vspace{0.05in}\frac{4}{3}
\end{mymatrix}
\end{eqnarray*}

Therefore, $Q = (\frac{10}{3}, \frac{17}{3}, \frac{4}{3})$. 

\end{solution}
