\section{Column space, row space, and null space of a matrix}

\begin{outcome}
  \begin{enumerate}
  \item Find a basis for the column space, row space, and null space
    of a matrix.
  \item Find the rank and nullity of a matrix.
  \end{enumerate}
\end{outcome}

There are three important spaces we can associate to a matrix. They
are called the column space, row space, and null space, and are
defined as follows.

\begin{definition}{Column space, row space, null space}{row-column-space}
  Let $A$ be an $m\times n$-matrix.  The \textbf{column space}%
  \index{column space}%
  \index{matrix!column space} of $A$, written $\col(A)$, is the span
  of the columns. The \textbf{row space}%
  \index{row space}%
  \index{matrix!row space} of $A$, written $\row(A)$, is the span of
  the rows.  The \textbf{null space}%
  \index{null space}%
  \index{matrix!null space} of $A$, written $\nullspace(A)$, is the
  set
  \begin{equation*}
    \nullspace(A) =\set{\vect{x} \mid A \vect{x} =\vect{0}}.
  \end{equation*}
\end{definition}

Note that the column space is a subspace of $\R^m$ and the null space
is a subspace of $\R^n$. The row space, on the other hand, is a set of
row vectors. It can be regarded as a subspace of $\R^m$, but only if
we regard $\R^m$ as the set of $m$-dimensional row vectors (and not
column vectors, as usual).

Before we give an example, recall that two matrices are called
\textbf{row equivalent}%
\index{matrix!row equivalence}%
\index{row equivalence} if one can be obtained from the other by
performing a sequence of elementary row operations. The point of
elementary row operations is that they do not affect the row space or
the null space of the matrix. (They do, however, affect the column
space). The following proposition makes this more precise.

\begin{proposition}{Effect of row operations}{row-operations-row-space}
  Let $A$ and $B$ be row equivalent matrices. They $\row(A)=\row(B)$
  and $\nullspace(A)=\nullspace(B)$.
\end{proposition}

\begin{proof}
  The fact that elementary row operations do not change the null space
  is a special case of
  Theorem~\ref{thm:elementary-operations-and-solns}, applied to a
  homogeneous system. To prove that they do not change the row space
  is also easy; we just need to look at each kind of elementary row
  operation. For example, adding a multiple of one row to another
  clearly does not change the span of the rows.
\end{proof}

\begin{example}{Basis of column space, row space, and null space}{basis-column-row-null}
  Find a basis for the column space, row space, and null space of the
  matrix
  \begin{equation*}
    A =
    \begin{mymatrix}{rrrrr}
      1 & 2 & 1 & 3 & 2 \\
      1 & 3 & 6 & 0 & 2 \\
      3 & 7 & 8 & 6 & 6 \\
    \end{mymatrix}.
  \end{equation*}
\end{example}

\begin{solution}
  The column space of $A$ is the span of the columns of $A$, i.e.,
  \begin{equation*}
    \col(A) = \sspan\set{
      \begin{mymatrix}{r} 1 \\ 1 \\ 3 \end{mymatrix},~
      \begin{mymatrix}{r} 2 \\ 3 \\ 7 \end{mymatrix},~
      \begin{mymatrix}{r} 1 \\ 6 \\ 8 \end{mymatrix},~
      \begin{mymatrix}{r} 3 \\ 0 \\ 6 \end{mymatrix},~
      \begin{mymatrix}{r} 2 \\ 2 \\ 6 \end{mymatrix}
    }.
  \end{equation*}
  To find a basis for the column space, we use the casting-out
  algorithm.  The {\rref} of $A$ is
  \begin{equation}\label{eqn:basis-column-row-null-1}
    \begin{mymatrix}{rrrrr}
      \circled{1} & 0 & -9 & 9 & 2 \\
      0 & \circled{1} & 5 & -3 & 0 \\
      0 & 0 & 0 & 0 & 0 \\
    \end{mymatrix}.
  \end{equation}
  Note that the first two columns of the {\rref} are pivot
  columns. Therefore, by the casting-out algorithm, the first two
  columns of $A$ form a basis for the column space. Thus, the
  following is a basis for the column space:
  \begin{equation*}
    \mbox{Basis of $\col(A)$:} \quad
    \set{
      \begin{mymatrix}{r} 1 \\ 1 \\ 3 \end{mymatrix},~
      \begin{mymatrix}{r} 2 \\ 3 \\ 7 \end{mymatrix}
    }.
  \end{equation*}
  The rows space of $A$ is the span of the rows of $A$, i.e.,
  \begin{equation*}
    \row(A) =
    \sspan \set{
      \begin{mymatrix}{rrrrr}
        1 & 2 & 1 & 3 & 2 \\
      \end{mymatrix},~
      \begin{mymatrix}{rrrrr}
      1 & 3 & 6 & 0 & 2 \\
      \end{mymatrix},~
      \begin{mymatrix}{rrrrr}
      3 & 7 & 8 & 6 & 6
      \end{mymatrix}
    }
  \end{equation*}
  We could find a basis of the row space by writing all three rows as
  column vectors and using the casting-out algorithm. However, there
  is an easier way. By
  Proposition~\ref{prop:row-operations-row-space}, the row space of
  $A$ is equal to the row space of the {\rref}
  {\eqref{eqn:basis-column-row-null-1}}. Moreover, the non-zero rows
  of the {\rref} are clearly linearly independent (no non-zero row can
  be a linear combination of other rows below it, because each
  non-zero row has a pivot entry). Therefore, the non-zero rows of the
  {\rref} form a basis of the row space.
  \begin{equation*}
    \mbox{Basis of $\row(A)$:} \quad
    \set{
      \begin{mymatrix}{rrrrr}
        1 & 0 & -9 & 9 & 2 \\
      \end{mymatrix},~
      \begin{mymatrix}{rrrrr}
        0 & 1 & 5 & -3 & 0 \\
      \end{mymatrix}
    }.
  \end{equation*}
  Finally, the null space of $A$ is just the solution space of the
  homogeneous system $A\vect{x}=\vect{0}$. Thus, finding a basis of
  the null space is the same as finding a set of basic solutions. From
  the {\rref}, we can easily find the general solution of
  $A\vect{x}=\vect{0}$, using three parameters $r$, $s$, $t$
  corresponding to the three non-pivot columns of
  {\eqref{eqn:basis-column-row-null-1}}. The general solution is:
  \begin{equation*}
    \vect{x} =
    r\begin{mymatrix}{r} 9 \\ -5 \\ 1 \\ 0 \\ 0 \end{mymatrix}
    +s\begin{mymatrix}{r} -9 \\ 3 \\ 0 \\ 1 \\ 0 \end{mymatrix}
    +t\begin{mymatrix}{r} -2 \\ 0 \\ 0 \\ 0 \\ 1 \end{mymatrix}.
  \end{equation*}
  Therefore, the following is a basis of the null space:
  \begin{equation*}
    \mbox{Basis of $\nullspace(A)$:} \quad
    \set{
    \begin{mymatrix}{r} 9 \\ -5 \\ 1 \\ 0 \\ 0 \end{mymatrix},~
    \begin{mymatrix}{r} -9 \\ 3 \\ 0 \\ 1 \\ 0 \end{mymatrix},~
    \begin{mymatrix}{r} -2 \\ 0 \\ 0 \\ 0 \\ 1 \end{mymatrix}
    }.
  \end{equation*}
\end{solution}

As the example shows, all three bases, for the column space, the row
space, and the null space of $A$, can be easily determined from the
{\rref}. In the next proposition, we use this information to determine
the dimensions of these three spaces. Recall from
Definition~\ref{def:rank} that the \textbf{rank}%
\index{rank}%
\index{matrix!rank} of a matrix is equal to the number of pivot
entries of its {\rref}.

\begin{proposition}{Dimension of column space, row space, and null space}{dimension-column-row-null}
  Let $A$ be an $m\times n$-matrix. Then the dimensions of the column
  space, row space, and null space of $A$ are as follows:
  \begin{equation*}
    \begin{array}{r@{~}c@{~}l}
      \dim(\col(A)) &=& \rank(A), \\
      \dim(\row(A)) &=& \rank(A), \\
      \dim(\nullspace(A)) &=& n-\rank(A). \\
    \end{array}
  \end{equation*}
\end{proposition}

\begin{proof}
  Let $r=\rank(A)$.  Following the same method as in
  Example~\ref{exa:basis-column-row-null}, we can use the casting-out
  algorithm to find a basis for the column space. Since the {\rref} of
  $A$ has $r$ pivot columns, the basis has $r$ elements, and therefore
  $\dim(\col(A))=r$. Also, the {\rref} has $r$ non-zero rows (since
  each non-zero row contains exactly one pivot entry). These form a
  basis of the row space, and therefore $\dim(\row(A))=r$. Finally,
  the dimension of the null space is equal to the number of parameters
  in the general solution of the system of equations
  $A\vect{x}=\vect{0}$. There is one parameter for each non-pivot
  column, and since $A$ has $n$ columns and $r$ pivot columns, it
  follows that $\dim(\nullspace(A)) = n-r$.
\end{proof}

Among other things, the proposition states that the ``row rank'' of a
matrix (the dimension of its row space) is always equal to the
``column rank'' (the dimension of the column space). This fact is not
at all obvious when one first considers the definition of a matrix. It
is often called the \textbf{rank theorem}%
\index{rank theorem}%
\index{matrix!rank theorem} and is one of the deep and mysterious
facts of linear algebra. It means, for example, that if we do
elementary column operations instead of elementary row operations, we
end up with exactly the same number of pivots. Since the ``row rank''
and ``column rank'' are always equal, we are justified in simply
calling this quantity the ``rank'' of the matrix.

There is also a name for the dimension of the null space. It is called
the \textbf{nullity}%
\index{nullity}%
\index{matrix!nullity} of the matrix, and is written $\nullity(A)$.
The last part of Proposition~\ref{prop:dimension-column-row-null} is
also called the \textbf{rank-nullity theorem}%
\index{rank-nullity theorem}%
\index{matrix!rank-nullity theorem}, and is often written in the form
\begin{equation*}
  \rank(A) + \nullity(A) = n.
\end{equation*}

\begin{example}{Rank and nullity}{rank-nullity}
  Find the rank and nullity of the matrix
  \begin{equation*}
    A = \begin{mymatrix}{rrrrrr}
      1 & 2 & 1 & 3 & 2 \\
      1 & 3 & 6 & 0 & 2 \\
      1 & 2 & 1 & 3 & 2 \\
      1 & 3 & 2 & 4 & 0
    \end{mymatrix}.
  \end{equation*}
\end{example}

\begin{solution}
  The {\rref} of $A$ is
  \begin{equation*}
    \def\arraystretch{1.4}
    \begin{mymatrix}{rrrrrr}
      1 & 0 & 0 & 0 & \frac{13}{2} \\
      0 & 1 & 0 & 2 & -\frac{5}{2} \\
      0 & 0 & 1 & -1 & \frac{1}{2} \\
      0 & 0 & 0 & 0 & 0
    \end{mymatrix},
  \end{equation*}
  and so $\rank(A)=3$ and $\nullity(A) = 5-3 = 2$.
\end{solution}

We conclude this section with two useful theorems about matrices.

\begin{theorem}{}{equivalent-rank1}
  The following are equivalent for an $m\times n$-matrix $A$.
  \begin{enumerate}
  \item $\rank(A)=n$.
  \item $\row(A)=\R^n$, i.e., the rows of $A$ span $\R^n$.
  \item The columns of $A$ are linearly independent in $\R^m$.
  \item The $n\times n$-matrix $A^TA$ is invertible.
  \item $A$ is left invertible, i.e., there exists an
    $n\times m$-matrix $B$ such that $BA=I$.
  \item The system $A\vect{x}=\vect{0}$ has only the trivial solution.
  \end{enumerate}
\end{theorem}

\begin{theorem}{}{equivalent-rank2}
  The following are equivalent for an $m\times n$-matrix $A$.
  \begin{enumerate}
  \item $\rank(A)=m$.
  \item $\col(A)=\R^m$, i.e., the columns of $A$ span $\R^m$.
  \item The rows of $A$ are linearly independent in $\R^n$.
  \item The $m\times m$-matrix $AA^T$ is invertible.
  \item $A$ is right invertible, i.e., there exists an
    $n\times m$-matrix $B$ such that $AB=I$.
  \item The system $A\vect{x}=\vect{b}$ is consistent for
    every $\vect{b}\in\R^m$.
  \end{enumerate}
\end{theorem}
