\section{Application: Balancing chemical reactions}

The tools of linear algebra can also be used in the subject area of Chemistry, specifically for balancing chemical reactions.
Consider the chemical reaction
\index{chemical reactions!balancing}
\begin{equation*}
SnO_{2}+H_{2}\rightarrow Sn+H_{2}O.
\end{equation*}
Here the elements involved are tin ($Sn$), oxygen ($O$), and hydrogen ($H$). A
chemical reaction occurs that transforms a combination of tin dioxide ($SnO_2$)
and hydrogen ($H_2$) into a combination of tin ($Sn$) and water ($H_{2}O$). When considering
chemical reactions, we want to investigate how much of each substance we began with and how much of each substance is involved in the result.

An important theory we will use here is the mass balance theory. It tells us that we cannot create or delete
elements within a chemical reaction. For example, in the above
expression, we must have the same number of atoms of oxygen, tin,
and hydrogen on both sides of the reaction. Notice that this is not currently the case.
 For example, there are two oxygen atoms on the left and only one
on the right. In order to fix this, we want to find numbers $x,y,z,w$ such that
\begin{equation*}
x\;SnO_{2}+y\;H_{2}\rightarrow z\;Sn+w\;H_{2}O,
\end{equation*}
where both sides of the reaction have the same number of atoms of the various elements.

This is a familiar problem. We can solve it by setting up a system of equations
in the variables $x,y,z,w$. Thus we need
\begin{equation*}
\begin{array}{cl}
Sn: & x=z \\
O: & 2x=w \\
H: & 2y=2w.
\end{array}
\end{equation*}
We can rewrite these equations as
\begin{equation*}
\begin{array}{cl}
Sn: & x - z = 0 \\
O: & 2x - w = 0 \\
H: & 2y - 2w = 0.
\end{array}
\end{equation*}
The augmented matrix for this system of equations is given by
\begin{equation*}
\begin{mymatrix}{rrrr|r}
1 & 0 & -1 & 0 & 0 \\
2 & 0 & 0 & -1 & 0 \\
0 & 2 & 0 & -2 & 0
\end{mymatrix}.
\end{equation*}
The {\rref} of this matrix is
\begin{equation*}
\def\arraystretch{1.2}
\begin{mymatrix}{rrrr|r}
1 & 0 & 0 & -\frac{1}{2} & 0 \\
0 & 1 & 0 & -1 & 0 \\
0 & 0 & 1 & -\frac{1}{2} & 0
\end{mymatrix},
\end{equation*}
and the solution is given in parametric form as
\begin{equation*}
\begin{array}{r@{~}c@{~}ll}
x &=& \frac{1}{2} t \\
y &=& t \\
z &=& \frac{1}{2}t \\
w &=& t.
\end{array}
\end{equation*}
For example, let $t=2$ and this would yield $x=1$, $y=2$, $z=1$, and
$w=2$. We can put these values back into the expression for the
reaction which yields
\begin{equation*}
SnO_{2}+2H_{2}\rightarrow Sn+2H_{2}O.
\end{equation*}
Observe that each side of the expression contains the same number of
atoms of each element. This means that the chemical reaction is
balanced. Of course, because it is a homogeneous system of equations, any
multiple of a solution is also a solution. For example,
\begin{equation*}
2SnO_{2}+4H_{2}\rightarrow 2Sn+4H_{2}O
\end{equation*}
is also correct. It just means that we have just doubled the amount of
every substance involved. In chemistry, the numbers you are finding
would typically be the number of mols of the molecules on each
side. Thus one mol of $SnO_2$ added two mols of $H_2$ yields one mol
of $Sn$ and two mols of $H_2O$.


Here is another example.

\begin{example}{Balancing a chemical reaction}{balancing-chem}
Potassium is denoted by $K$, oxygen by $O$,
phosphorus by $P$ and hydrogen by $H$.
Consider the reaction given by
\begin{equation*}
KOH+H_{3}PO_{4}\rightarrow K_{3}PO_{4}+H_{2}O.
\end{equation*}
Balance this chemical reaction.
\end{example}

\begin{solution}
We will use the same procedure as above to solve this problem. We need to find values for
$x,y,z,w$ such that
\begin{equation*}
x\;KOH+y\;H_{3}PO_{4}\rightarrow z\;K_{3}PO_{4}+w\;H_{2}O.
\end{equation*}
preserves the total number of atoms of each element.
Finding these values can be done by finding the solution to the following system of equations.
\begin{equation*}
\begin{array}{cl}
K: & x=3z \\
O: & x+4y=4z+w \\
H: & x+3y=2w \\
P: & y=z.
\end{array}
\end{equation*}
The augmented matrix for this system is
\begin{equation*}
\begin{mymatrix}{rrrr|r}
1 & 0 & -3 & 0 & 0 \\
1 & 4 & -4 & -1 & 0 \\
1 & 3 & 0 & -2 & 0 \\
0 & 1 & -1 & 0 & 0
\end{mymatrix},
\end{equation*}
and the {\rref} is
\begin{equation*}
\def\arraystretch{1.2}
\begin{mymatrix}{rrrr|r}
1 & 0 & 0 & -1 & 0 \\
0 & 1 & 0 & -\frac{1}{3} & 0 \\
0 & 0 & 1 & -\frac{1}{3} & 0 \\
0 & 0 & 0 & 0 & 0
\end{mymatrix}.
\end{equation*}

The general solution is given in terms of the parameter $t$ as
\begin{equation*}
\begin{array}{c}
x = t \\
y = \frac{1}{3}t \\
z = \frac{1}{3}t \\
w = t
\end{array}
\end{equation*}
Choose a value for $t$, say $3$. This yields $x=3$, $y=1$, $z=1$, and
$w=3$. It follows that the balanced reaction is given by
\begin{equation*}
3KOH+H_{3}PO_{4}\rightarrow K_{3}PO_{4}+3H_{2}O
\end{equation*}
Note that this results in the same number of atoms of each element on both sides.
\end{solution}

