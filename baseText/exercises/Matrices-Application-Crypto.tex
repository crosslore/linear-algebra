\section*{Exercises}

\begin{enumialphparenastyle}

\begin{ex}
  Encrypt the message ``Rendezvous at dawn'' using the Hill cipher with
  block size 3 and encryption matrix
  \begin{equation*}
    A ~=~ \begin{mymatrix}{ccc}
      2 & 1 & 1 \\
      1 & 3 & 1 \\
      1 & 1 & 4 \\
    \end{mymatrix}.
  \end{equation*}
  \begin{sol}
    Ciphertext: ``ZRUJPZVAEJTWOXGJZV''.
  \end{sol}
\end{ex}

\begin{ex}
  Decrypt the message ``ERM DXYBJUWW.JWQLD,HL'' using the Hill cipher with block size
  $3$ and encryption matrix
  \begin{equation*}
    A ~=~ \begin{mymatrix}{ccc}
      2 & 1 & 1 \\
      1 & 3 & 1 \\
      1 & 1 & 4 \\
    \end{mymatrix}.
  \end{equation*}
  \begin{sol}
    The decryption matrix is
    \begin{equation*}
      A^{-1} ~=~ \begin{mymatrix}{ccc}
        16 & 22 &  5 \\
        22 & 26 & 17 \\
        5  & 17 &  2 \\
      \end{mymatrix}.
    \end{equation*}
    Plaintext: ``Spies are at the gate''.
  \end{sol}
\end{ex}

\begin{ex}
  Eve intercepts the following encrypted message sent by Bob:
  \begin{center}
    ``TGVXKHGSW,JU,JHYJSCDSBQIRPEV''.
  \end{center}
  Eve knows that Alice uses a Hill cipher with block length 2, but she
  does not know the secret encryption matrix. Eve also knows that
  Bob begins all of his letters with ``Hello''. Decrypt the message.
  \begin{sol}
    The first two plaintext blocks are $(8,5),(12,12)$ and the first
    two ciphertext blocks are $(20,7),(22,24)$. Eve solves the equation
    \begin{equation*}
      A^{-1} \begin{mymatrix}{cc} 20 & 22 \\ 7 & 24 \end{mymatrix}
      = \begin{mymatrix}{cc} 8 & 12 \\ 5 & 12 \end{mymatrix}
    \end{equation*}
    to find the secret decryption matrix
    \begin{equation*}
      A^{-1} = \begin{mymatrix}{cc} 3 & 5 \\ 1 & 2 \end{mymatrix}.
    \end{equation*}
    The plaintext is ``Hello, password is kiwifruit''.
  \end{sol}
\end{ex}

\begin{ex}
  Encrypt the message ``Lost contact'' using the block cipher of
  Definition~\ref{def:toy-block-cipher} and the key
  $2,3,4,1,1,1,5,5,5,4,3,2$.
  \begin{sol}
    Ciphertext: ``VXUAJYY,AFJE''.
  \end{sol}
\end{ex}

\begin{ex}
  Decrypt the message ``NRQEUAPOM GLFN,'' using the block cipher of
  Definition~\ref{def:toy-block-cipher} and the key
  $1,1,1,2,2,2,3,3,3,4,4,4$. \textbf{Hint:} To decrypt, we must
  perform all the encryption steps in reverse. To undo a key mixture
  step, we subtract the relevant key components. To undo an S-box
  application, we apply the S-box in reverse. To undo a diffusion
  step, multiply by the inverse of the diffusion matrix.
  \begin{sol}
    The inverse of the diffusion matrix is
    \begin{equation*}
      A^{-1} = \begin{mymatrix}{ccc}
        11 & 2 & 21 \\
        21 & 11 & 2 \\
        2 & 21 & 11 \\
      \end{mymatrix}.
    \end{equation*}
    The plaintext is: ``Eat more fruit''.
  \end{sol}
\end{ex}

\end{enumialphparenastyle}
